<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Spatial Data Science with R</title>
  <meta name="description" content="description_xx">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Spatial Data Science with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="description_xx" />
  <meta name="github-repo" content="edzer/sdsr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Spatial Data Science with R" />
  
  <meta name="twitter:description" content="description_xx" />
  

<meta name="author" content="Edzer Pebesma, Roger Bivand">


<meta name="date" content="2018-05-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="intro.html">
<link rel="next" href="geometries.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial Data Science with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Spatial Data</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#a-first-map"><i class="fa fa-check"></i><b>1.1</b> A first map</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#reading"><i class="fa fa-check"></i><b>1.2</b> Reading and writing</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="spaces.html"><a href="spaces.html"><i class="fa fa-check"></i><b>2</b> Spaces</a><ul>
<li class="chapter" data-level="2.1" data-path="spaces.html"><a href="spaces.html#cartesian-and-polar-coordinates"><i class="fa fa-check"></i><b>2.1</b> Cartesian and polar coordinates</a></li>
<li class="chapter" data-level="2.2" data-path="spaces.html"><a href="spaces.html#spherical-and-ellipsoidal-coordinates"><i class="fa fa-check"></i><b>2.2</b> Spherical and ellipsoidal coordinates</a></li>
<li class="chapter" data-level="2.3" data-path="spaces.html"><a href="spaces.html#distances"><i class="fa fa-check"></i><b>2.3</b> Distances</a></li>
<li class="chapter" data-level="2.4" data-path="spaces.html"><a href="spaces.html#bounded-spaces"><i class="fa fa-check"></i><b>2.4</b> Bounded spaces</a></li>
<li class="chapter" data-level="2.5" data-path="spaces.html"><a href="spaces.html#time"><i class="fa fa-check"></i><b>2.5</b> Time</a></li>
<li class="chapter" data-level="2.6" data-path="spaces.html"><a href="spaces.html#exercises-1"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geometries.html"><a href="geometries.html"><i class="fa fa-check"></i><b>3</b> Geometries</a></li>
<li class="chapter" data-level="4" data-path="vectorraster.html"><a href="vectorraster.html"><i class="fa fa-check"></i><b>4</b> Vector/Raster</a></li>
<li class="chapter" data-level="5" data-path="geommanip.html"><a href="geommanip.html"><i class="fa fa-check"></i><b>5</b> Geometric Manipulations</a><ul>
<li class="chapter" data-level="5.1" data-path="geommanip.html"><a href="geommanip.html#unary-operations"><i class="fa fa-check"></i><b>5.1</b> Unary Operations</a></li>
<li class="chapter" data-level="5.2" data-path="geommanip.html"><a href="geommanip.html#binary-operations"><i class="fa fa-check"></i><b>5.2</b> Binary Operations</a></li>
<li class="chapter" data-level="5.3" data-path="geommanip.html"><a href="geommanip.html#n-ary-operations"><i class="fa fa-check"></i><b>5.3</b> N-ary Operations</a></li>
<li class="chapter" data-level="5.4" data-path="geommanip.html"><a href="geommanip.html#warnings-for-longitudelatitude-geometries"><i class="fa fa-check"></i><b>5.4</b> Warnings for longitude/latitude geometries</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="featureattributes.html"><a href="featureattributes.html"><i class="fa fa-check"></i><b>6</b> Feature attributes</a><ul>
<li class="chapter" data-level="6.1" data-path="featureattributes.html"><a href="featureattributes.html#agr"><i class="fa fa-check"></i><b>6.1</b> Attribute-geometry relationship</a></li>
<li class="chapter" data-level="6.2" data-path="featureattributes.html"><a href="featureattributes.html#spatial-join"><i class="fa fa-check"></i><b>6.2</b> Spatial join</a></li>
<li class="chapter" data-level="6.3" data-path="featureattributes.html"><a href="featureattributes.html#aggregate-and-summarise"><i class="fa fa-check"></i><b>6.3</b> Aggregate and summarise</a></li>
<li class="chapter" data-level="6.4" data-path="featureattributes.html"><a href="featureattributes.html#intersections"><i class="fa fa-check"></i><b>6.4</b> Intersections</a></li>
<li class="chapter" data-level="6.5" data-path="featureattributes.html"><a href="featureattributes.html#area-weighted-interpolation"><i class="fa fa-check"></i><b>6.5</b> Area-weighted interpolation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="reference-systems.html"><a href="reference-systems.html"><i class="fa fa-check"></i><b>7</b> Reference Systems</a><ul>
<li class="chapter" data-level="7.1" data-path="reference-systems.html"><a href="reference-systems.html#units"><i class="fa fa-check"></i><b>7.1</b> Units of measurement</a></li>
<li class="chapter" data-level="7.2" data-path="reference-systems.html"><a href="reference-systems.html#transform"><i class="fa fa-check"></i><b>7.2</b> Coordinate transformation and conversion</a></li>
</ul></li>
<li class="part"><span><b>II Maps</b></span></li>
<li class="chapter" data-level="8" data-path="plotting-spatial-data.html"><a href="plotting-spatial-data.html"><i class="fa fa-check"></i><b>8</b> Plotting spatial data</a></li>
<li class="chapter" data-level="9" data-path="plot.html"><a href="plot.html"><i class="fa fa-check"></i><b>9</b> Base Plot</a></li>
<li class="chapter" data-level="10" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>10</b> ggplot2</a></li>
<li class="chapter" data-level="11" data-path="interactive-maps.html"><a href="interactive-maps.html"><i class="fa fa-check"></i><b>11</b> Interactive Maps</a></li>
<li class="part"><span><b>III Spatial Analysis</b></span></li>
<li class="chapter" data-level="12" data-path="summarizing-geometries.html"><a href="summarizing-geometries.html"><i class="fa fa-check"></i><b>12</b> Summarizing Geometries</a></li>
<li class="chapter" data-level="13" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html"><i class="fa fa-check"></i><b>13</b> Point Pattern Analysis</a></li>
<li class="chapter" data-level="14" data-path="manipulating-attributes-summarise-aggregate-union-sample.html"><a href="manipulating-attributes-summarise-aggregate-union-sample.html"><i class="fa fa-check"></i><b>14</b> Manipulating attributes: summarise, aggregate, union, sample</a></li>
<li class="chapter" data-level="15" data-path="units-of-measure-revisited-attribute-units-intensive-and-extensive-variables.html"><a href="units-of-measure-revisited-attribute-units-intensive-and-extensive-variables.html"><i class="fa fa-check"></i><b>15</b> Units of measure revisited: attribute units, intensive and extensive variables</a></li>
<li class="chapter" data-level="16" data-path="up-and-downscaling.html"><a href="up-and-downscaling.html"><i class="fa fa-check"></i><b>16</b> Up- and Downscaling</a></li>
<li class="chapter" data-level="17" data-path="spatial-interpolation-and-geostatistics.html"><a href="spatial-interpolation-and-geostatistics.html"><i class="fa fa-check"></i><b>17</b> Spatial Interpolation and geostatistics</a></li>
<li class="chapter" data-level="18" data-path="area-data-and-spatial-correlation.html"><a href="area-data-and-spatial-correlation.html"><i class="fa fa-check"></i><b>18</b> Area Data and Spatial Correlation</a></li>
<li class="chapter" data-level="19" data-path="spatial-regression-and-autocorrelation.html"><a href="spatial-regression-and-autocorrelation.html"><i class="fa fa-check"></i><b>19</b> Spatial Regression and Autocorrelation</a></li>
<li class="chapter" data-level="20" data-path="raster-modelling.html"><a href="raster-modelling.html"><i class="fa fa-check"></i><b>20</b> Raster Modelling</a></li>
<li class="part"><span><b>IV Spatiotemporal Analysis</b></span></li>
<li class="chapter" data-level="21" data-path="array.html"><a href="array.html"><i class="fa fa-check"></i><b>21</b> Array data: raster and vector data cubes</a></li>
<li class="chapter" data-level="22" data-path="movement-data.html"><a href="movement-data.html"><i class="fa fa-check"></i><b>22</b> Movement data</a></li>
<li class="chapter" data-level="23" data-path="statistical-modelling-of-spatiotemporal-data.html"><a href="statistical-modelling-of-spatiotemporal-data.html"><i class="fa fa-check"></i><b>23</b> Statistical modelling of spatiotemporal data</a></li>
<li class="chapter" data-level="24" data-path="scalability.html"><a href="scalability.html"><i class="fa fa-check"></i><b>24</b> Scalability</a></li>
<li class="chapter" data-level="" data-path="r-data-structures.html"><a href="r-data-structures.html"><i class="fa fa-check"></i>R data structures</a><ul>
<li class="chapter" data-level="24.1" data-path="r-data-structures.html"><a href="r-data-structures.html#homogeneous-vectors"><i class="fa fa-check"></i><b>24.1</b> Homogeneous vectors</a></li>
<li class="chapter" data-level="24.2" data-path="r-data-structures.html"><a href="r-data-structures.html#heterogeneous-vectors-list"><i class="fa fa-check"></i><b>24.2</b> Heterogeneous vectors: list</a></li>
<li class="chapter" data-level="24.3" data-path="r-data-structures.html"><a href="r-data-structures.html#attributes"><i class="fa fa-check"></i><b>24.3</b> Attributes</a></li>
<li class="chapter" data-level="24.4" data-path="r-data-structures.html"><a href="r-data-structures.html#various-names-attributes"><i class="fa fa-check"></i><b>24.4</b> various names attributes</a></li>
<li class="chapter" data-level="24.5" data-path="r-data-structures.html"><a href="r-data-structures.html#using-structure"><i class="fa fa-check"></i><b>24.5</b> using structure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial Data Science with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spaces" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Spaces</h1>
<p>For spatial data, the location of observations are characterised by coordinates, and coordinates are defined in a certain space. Different spaces are used for this, and the most important difference is whether coordinates are defined over a 2-dimensional or 3-dimensional space referenced to orthogonal axes (Cartesian coordinates), or using distance and direction angles (polar coordinates, spherical coordinates).</p>
<div class="figure" style="text-align: center"><span id="fig:polar"></span>
<img src="sdsr_files/figure-html/polar-1.png" alt="Two-dimensional polar (red) and Cartesian (blue) coordinates" width="672" />
<p class="caption">
Figure 2.1: Two-dimensional polar (red) and Cartesian (blue) coordinates
</p>
</div>
<div id="cartesian-and-polar-coordinates" class="section level2">
<h2><span class="header-section-number">2.1</span> Cartesian and polar coordinates</h2>
<p>Figure <a href="spaces.html#fig:polar">2.1</a> shows both polar and Cartesian coordinates for a standard two-dimensional situation. In Cartesian coordinates, the point shown is <span class="math inline">\((x,y) = (3,4)\)</span>, for polar coordinates it is <span class="math inline">\((r,\phi) = (5, \mbox{arctan}(4/3))\)</span>, where <span class="math inline">\(\mbox{arctan}(4/3)\)</span> is approximately <span class="math inline">\(0.93\)</span> radians, or <span class="math inline">\(53^{\circ}\)</span>. Note that <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> and <span class="math inline">\(r\)</span> all have length units, where <span class="math inline">\(\phi\)</span> is an angle (a unitless length/length ratio). Converting back and forth between Cartesian and polar coordinates is trivial, <span class="math display">\[x = r~\mbox{cos} \phi\]</span> <span class="math display">\[y = r~\mbox{sin} \phi\]</span> <span class="math display">\[\phi = \mbox{arctan}(y/x)\]</span> <span class="math display">\[r = \sqrt{x^2 + y^2}\]</span> but requires care with using the right quadrant for <span class="math inline">\(\mbox{arctan}\)</span>; the <code>atan2</code> function is helpful here.</p>
</div>
<div id="spherical-and-ellipsoidal-coordinates" class="section level2">
<h2><span class="header-section-number">2.2</span> Spherical and ellipsoidal coordinates</h2>
<p>In three dimensions, where Cartesian coordinates are expressed as <span class="math inline">\((x,y,z)\)</span>, spherical coordinates are the three-dimensional equivalent of polar coordinates and can be expressed as <span class="math inline">\((r,\lambda,\phi)\)</span>, where</p>
<ul>
<li><span class="math inline">\(r\)</span> is the distance (or altitude)</li>
<li><span class="math inline">\(\lambda\)</span> is the longitude, measured in the <span class="math inline">\((x,y)\)</span> plane counter-clockwise from positive <span class="math inline">\(x\)</span>, and</li>
<li><span class="math inline">\(\phi\)</span> is the latitude, the angle between the vector and the <span class="math inline">\((x,y)\)</span> plane.</li>
</ul>
<p>When we are only interested in points on a sphere with given radius, we can drop <span class="math inline">\(r\)</span> and <span class="math inline">\((\lambda,\phi)\)</span> suffice to identify any point.</p>
<p>It should be noted that this is just <em>a</em> definition, one could for instance also choose to measure polar angle, the angle between the vector and <span class="math inline">\(z\)</span>, instead of latitude. There is also a long tradition of specifying points as <span class="math inline">\((\phi,\lambda)\)</span> but throughout this book we will stick to longitude-latitude, <span class="math inline">\((\lambda,\phi)\)</span>.</p>
<p>For points on an ellipse, there are two ways in which angle can be expressed (figure <a href="spaces.html#fig:ellipse">2.2</a>): measured from the center of the ellipse (<span class="math inline">\(\psi\)</span>), or measured perpendicular to the tangent on the ellipse at the target point (<span class="math inline">\(\phi\)</span>).</p>
<div class="figure" style="text-align: center"><span id="fig:ellipse"></span>
<img src="sdsr_files/figure-html/ellipse-1.png" alt="Angles on an ellipse: geodetic (blue) and geocentric (red) latitude" width="672" />
<p class="caption">
Figure 2.2: Angles on an ellipse: geodetic (blue) and geocentric (red) latitude
</p>
</div>
<p>The most common parametric model for the Earth is a spheroid, also called an ellipsoid of revolution, which is an ellipsoid with two equal semi-axes. In effect, this is a flattened sphere: the distance between the poles is (slightly: about 0.33%) smaller than the distance between two opposite points on the equator. Under this model, longitude is always measured along a circle, but latitude along an ellispe. If we think of figure <a href="spaces.html#fig:ellipse">2.2</a> as a cross section of the Earth passing through the poles, the latitude measure <span class="math inline">\(\phi\)</span> is the one used when no further specification is given; it is also called <em>geodetic latitude</em>. The latitude measure <span class="math inline">\(\psi\)</span> is called the <em>geocentric latitude</em>.</p>
<p>In addition to longitude and latitude we can add <em>altitude</em> to define points that are not on the spheroid, and obtain a three dimensional space again. When defining altitude, we need to choose where zero altitude is (on the ellipsoid, or on the mean sea level?), as well as which direction is positive (usually upwards), and which direction is “straight up”: perpendicular to the spheroid surface, or in the direction opposite to gravitation? All these choices may matter, depending on the application area.</p>
</div>
<div id="distances" class="section level2">
<h2><span class="header-section-number">2.3</span> Distances</h2>
<p>Distances between two points <span class="math inline">\(p_i\)</span> and <span class="math inline">\(p_j\)</span> in Cartesian coordinates are computed as Euclidian distances, in two dimensions by <span class="math display">\[d_{ij} = \sqrt{(x_i-x_j)^2+(y_i-y_j)^2}\]</span> with <span class="math inline">\(p_i = (x_i,y_i)\)</span> and in three dimensions by <span class="math display">\[d_{ij} = \sqrt{(x_i-x_j)^2+(y_i-y_j)^2+(z_i-z_j)^2}\]</span> with <span class="math inline">\(p_i = (x_i,y_i,z_i).\)</span> These distances represent the length of a <em>straight</em> line between two points <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>.</p>
<p>For two points on a circle, the length of the arc of two points <span class="math inline">\(c_1 = (r,{\phi}_i)\)</span> and <span class="math inline">\(c_2 = (r, \phi_2)\)</span> is <span class="math display">\[s_{ij}=r~|\phi_1-\phi_2| = r ~\theta\]</span> with <span class="math inline">\(\theta\)</span> the angle between <span class="math inline">\(\phi_1\)</span> and <span class="math inline">\(\phi_2\)</span> in radians. For very small values of <span class="math inline">\(\theta\)</span>, we will have <span class="math inline">\(s_{ij} \approx d_{ij}\)</span>.</p>
<p>For two points <span class="math inline">\(p_1 = (\lambda_1,\phi_1)\)</span> and <span class="math inline">\(p_2 = (\lambda_2,\phi_2)\)</span> on a sphere with radius <span class="math inline">\(r&#39;\)</span>, the <em>great circle distance</em> is the arc length between <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> on the circle that passes through <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> and has the center of the sphere as its center, and is given by <span class="math inline">\(s_{12} = r ~ \theta_{12}\)</span> with <span class="math display">\[\theta_{12} = \arccos(\sin \phi_1 \cdot \sin \phi_2 + \cos \phi_1 \cdot \cos \phi_2 \cdot \cos(|\lambda_1-\lambda_2|))\]</span> the angle in radians.</p>
<p>Arc distances between two points on a spheroid are more complicated to compute. Details about the computation method used in package <code>lwgeom</code> (which, in turn, is used by package <code>sf</code>) are given in <span class="citation">(Karney <a href="#ref-karney2013algorithms">2013</a>)</span>.</p>
</div>
<div id="bounded-spaces" class="section level2">
<h2><span class="header-section-number">2.4</span> Bounded spaces</h2>
<p>All the above assumes pure geometric computations in spaces where there are no unexpected obstructions. When we move through space on a daily basis, we typically find constraints e.g.</p>
<ul>
<li>when we walk through a building</li>
<li>when we cycle to work</li>
<li>or when we drive to a shop.</li>
</ul>
<p>Distances, in such case, can be made up of a sequence of shortest (straight line or great circle) distances, but follow a more complex path than a straight line. Typical constraints come from road networks, or from the requirement for a certain habitat (water for fish, forest for certain bird species).</p>
</div>
<div id="time" class="section level2">
<h2><span class="header-section-number">2.5</span> Time</h2>
<p>When we describe over which “space” a certain phenomenon is characterised, time forms an integral component: nothing exists forever. It is tempting to think that time, compared to geographical “space”, is one-dimensional and that is often the way we address time, e.g. in R where <code>Date</code> is represented by the number of days since 1970-01-01</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="dt">d =</span> <span class="kw">as.Date</span>(<span class="st">&quot;1970-02-01&quot;</span>))
<span class="co">#&gt; [1] &quot;1970-02-01&quot;</span>
<span class="kw">as.numeric</span>(d)
<span class="co">#&gt; [1] 31</span></code></pre></div>
<p>and <code>POSIXt</code> time by the number of seconds since that date</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="dt">t =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;1970-01-02 00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;UTC&quot;</span>))
<span class="co">#&gt; [1] &quot;1970-01-02 UTC&quot;</span>
<span class="kw">as.numeric</span>(t)
<span class="co">#&gt; [1] 86400</span></code></pre></div>
<p>In practical cases however, we may be interested in how certain phenomena vary over the day, or over the year, in which case it may more convenient to represent time as the tuple (year, day-of-year), or (day, time-of-day). When we study for instance traffic patterns, day of week plays a role, in which we may end up with (year, week-of-year, day-of-week, time-of-day) in order to quantify within-day, within-week, within-year and between-year signals.</p>
</div>
<div id="exercises-1" class="section level2">
<h2><span class="header-section-number">2.6</span> Exercises</h2>
<ul>
<li>convert the <span class="math inline">\((x,y)\)</span> points <span class="math inline">\((10,2)\)</span>, <span class="math inline">\((-10,-2)\)</span>, <span class="math inline">\((10,-2)\)</span> and <span class="math inline">\((0,10)\)</span> to polar coordinates</li>
<li>convert the polar <span class="math inline">\((r,\phi)\)</span> points <span class="math inline">\((10,45^{\circ})\)</span>, <span class="math inline">\((0,100^{\circ})\)</span> and <span class="math inline">\((5,359^{\circ})\)</span> to Cartesian coordinates</li>
<li>assuming the Earth is a sphere with radius is 6371 km, compute for <span class="math inline">\((\lambda,\phi)\)</span> points the great circle distance between <span class="math inline">\((10,10)\)</span> and <span class="math inline">\((11,10)\)</span>, between <span class="math inline">\((10,80)\)</span> and <span class="math inline">\((11,80)\)</span>, between <span class="math inline">\((10,10)\)</span> and <span class="math inline">\((10,11)\)</span> and between <span class="math inline">\((10,80)\)</span> and <span class="math inline">\((10,81)\)</span> (units: degree).</li>
</ul>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-karney2013algorithms">
<p>Karney, Charles FF. 2013. “Algorithms for Geodesics.” <em>Journal of Geodesy</em> 87 (1). Springer: 43–55. <a href="https://link.springer.com/content/pdf/10.1007/s00190-012-0578-z.pdf" class="uri">https://link.springer.com/content/pdf/10.1007/s00190-012-0578-z.pdf</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="geometries.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/edzer/sdsr/edit/master/02-Spaces.Rmd",
"text": "Edit"
},
"download": ["sdsr.pdf", "sdsr.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
