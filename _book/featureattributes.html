<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Attributes, Up- and Downscaling | Spatial Data Science</title>
  <meta name="description" content="description_xx" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Attributes, Up- and Downscaling | Spatial Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="description_xx" />
  <meta name="github-repo" content="edzer/sdsr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Attributes, Up- and Downscaling | Spatial Data Science" />
  
  <meta name="twitter:description" content="description_xx" />
  

<meta name="author" content="Edzer Pebesma, Roger Bivand" />


<meta name="date" content="2021-02-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spherical.html"/>
<link rel="next" href="raster.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/fgb.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/flatgeobuf-geojson.min.js"></script>
<script src="libs/chromajs-2.1.0/chroma.min.js"></script>
<link id="_-BIR74-1-attachment" rel="attachment" href="libs/_-BIR74-0.0.1/_-BIR74_layer.fgb"/>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = false;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Spatial Data</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#a-first-map"><i class="fa fa-check"></i><b>1.1</b> A first map</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#coordinate-reference-systems"><i class="fa fa-check"></i><b>1.2</b> Coordinate reference systems</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#raster-and-vector-data"><i class="fa fa-check"></i><b>1.3</b> Raster and vector data</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#raster-types"><i class="fa fa-check"></i><b>1.4</b> Raster types</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#time-series-arrays-data-cubes"><i class="fa fa-check"></i><b>1.5</b> Time series, arrays, data cubes</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#support"><i class="fa fa-check"></i><b>1.6</b> Support</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#spatial-data-science-software"><i class="fa fa-check"></i><b>1.7</b> Spatial data science software</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cs.html"><a href="cs.html"><i class="fa fa-check"></i><b>2</b> Coordinates</a><ul>
<li class="chapter" data-level="2.1" data-path="cs.html"><a href="cs.html#units"><i class="fa fa-check"></i><b>2.1</b> Quantities and units</a></li>
<li class="chapter" data-level="2.2" data-path="cs.html"><a href="cs.html#ellipsoidal-coordinates"><i class="fa fa-check"></i><b>2.2</b> Ellipsoidal coordinates</a></li>
<li class="chapter" data-level="2.3" data-path="cs.html"><a href="cs.html#crs"><i class="fa fa-check"></i><b>2.3</b> Coordinate Reference Systems</a></li>
<li class="chapter" data-level="2.4" data-path="cs.html"><a href="cs.html#proj-and-mapping-accuracy"><i class="fa fa-check"></i><b>2.4</b> PROJ and mapping accuracy</a></li>
<li class="chapter" data-level="2.5" data-path="cs.html"><a href="cs.html#exercises-1"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geometries.html"><a href="geometries.html"><i class="fa fa-check"></i><b>3</b> Geometries</a><ul>
<li class="chapter" data-level="3.1" data-path="geometries.html"><a href="geometries.html#simple-feature-geometries"><i class="fa fa-check"></i><b>3.1</b> Simple feature geometries</a></li>
<li class="chapter" data-level="3.2" data-path="geometries.html"><a href="geometries.html#opgeom"><i class="fa fa-check"></i><b>3.2</b> Operations on geometries</a></li>
<li class="chapter" data-level="3.3" data-path="geometries.html"><a href="geometries.html#precision"><i class="fa fa-check"></i><b>3.3</b> Precision</a></li>
<li class="chapter" data-level="3.4" data-path="geometries.html"><a href="geometries.html#coverages"><i class="fa fa-check"></i><b>3.4</b> Coverages: tesselations and rasters</a></li>
<li class="chapter" data-level="3.5" data-path="geometries.html"><a href="geometries.html#networks"><i class="fa fa-check"></i><b>3.5</b> Networks</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spherical.html"><a href="spherical.html"><i class="fa fa-check"></i><b>4</b> Spherical Geometries</a><ul>
<li class="chapter" data-level="4.1" data-path="spherical.html"><a href="spherical.html#straight-lines"><i class="fa fa-check"></i><b>4.1</b> Straight lines</a></li>
<li class="chapter" data-level="4.2" data-path="spherical.html"><a href="spherical.html#ring-direction"><i class="fa fa-check"></i><b>4.2</b> Ring direction</a></li>
<li class="chapter" data-level="4.3" data-path="spherical.html"><a href="spherical.html#full-polygon"><i class="fa fa-check"></i><b>4.3</b> Full polygon</a></li>
<li class="chapter" data-level="4.4" data-path="spherical.html"><a href="spherical.html#bounding-box-rectangle-and-cap"><i class="fa fa-check"></i><b>4.4</b> Bounding box, rectangle, and cap</a></li>
<li class="chapter" data-level="4.5" data-path="spherical.html"><a href="spherical.html#validity-on-the-sphere"><i class="fa fa-check"></i><b>4.5</b> Validity on the sphere</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="featureattributes.html"><a href="featureattributes.html"><i class="fa fa-check"></i><b>5</b> Attributes, Up- and Downscaling</a><ul>
<li class="chapter" data-level="5.1" data-path="featureattributes.html"><a href="featureattributes.html#agr"><i class="fa fa-check"></i><b>5.1</b> Attribute-geometry relationships</a></li>
<li class="chapter" data-level="5.2" data-path="featureattributes.html"><a href="featureattributes.html#spatial-join"><i class="fa fa-check"></i><b>5.2</b> Spatial join</a></li>
<li class="chapter" data-level="5.3" data-path="featureattributes.html"><a href="featureattributes.html#aggregating-and-summarising"><i class="fa fa-check"></i><b>5.3</b> Aggregating and Summarising</a></li>
<li class="chapter" data-level="5.4" data-path="featureattributes.html"><a href="featureattributes.html#area-weighted"><i class="fa fa-check"></i><b>5.4</b> Area-weighted interpolation</a></li>
<li class="chapter" data-level="5.5" data-path="featureattributes.html"><a href="featureattributes.html#exercises-2"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="raster.html"><a href="raster.html"><i class="fa fa-check"></i><b>6</b> Raster and vector datacubes</a><ul>
<li class="chapter" data-level="6.1" data-path="raster.html"><a href="raster.html#package-stars"><i class="fa fa-check"></i><b>6.1</b> Package <code>stars</code></a></li>
<li class="chapter" data-level="6.2" data-path="raster.html"><a href="raster.html#raster-data"><i class="fa fa-check"></i><b>6.2</b> Raster data</a></li>
<li class="chapter" data-level="6.3" data-path="raster.html"><a href="raster.html#datacubes"><i class="fa fa-check"></i><b>6.3</b> Vector Datacubes</a></li>
<li class="chapter" data-level="6.4" data-path="raster.html"><a href="raster.html#exercises-3"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="updownscaling.html"><a href="updownscaling.html"><i class="fa fa-check"></i><b>7</b> Up- and Downscaling</a></li>
<li class="part"><span><b>II R for Spatial Data Science</b></span></li>
<li class="chapter" data-level="8" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>8</b> Plotting spatial data</a><ul>
<li class="chapter" data-level="8.1" data-path="plotting.html"><a href="plotting.html#transform"><i class="fa fa-check"></i><b>8.1</b> Every plot is a projection</a></li>
<li class="chapter" data-level="8.2" data-path="plotting.html"><a href="plotting.html#plotting-points-lines-polygons-grid-cells"><i class="fa fa-check"></i><b>8.2</b> Plotting points, lines, polygons, grid cells</a></li>
<li class="chapter" data-level="8.3" data-path="plotting.html"><a href="plotting.html#classintervals"><i class="fa fa-check"></i><b>8.3</b> Color palettes and class intervals</a></li>
<li class="chapter" data-level="8.4" data-path="plotting.html"><a href="plotting.html#poles-and-datelines"><i class="fa fa-check"></i><b>8.4</b> Poles and datelines</a></li>
<li class="chapter" data-level="8.5" data-path="plotting.html"><a href="plotting.html#graticule"><i class="fa fa-check"></i><b>8.5</b> Graticules and other navigation aids</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="plot.html"><a href="plot.html"><i class="fa fa-check"></i><b>9</b> Base and grid plots</a><ul>
<li class="chapter" data-level="9.1" data-path="plot.html"><a href="plot.html#base-plots"><i class="fa fa-check"></i><b>9.1</b> Base plots</a></li>
<li class="chapter" data-level="9.2" data-path="plot.html"><a href="plot.html#combining-base-plots"><i class="fa fa-check"></i><b>9.2</b> Combining base plots</a></li>
<li class="chapter" data-level="9.3" data-path="plot.html"><a href="plot.html#grid-plots-and-viewports"><i class="fa fa-check"></i><b>9.3</b> Grid plots and viewports</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>10</b> ggplot2</a><ul>
<li class="chapter" data-level="10.1" data-path="ggplot2.html"><a href="ggplot2.html#geom_sf"><i class="fa fa-check"></i><b>10.1</b> <code>geom_sf</code></a></li>
<li class="chapter" data-level="10.2" data-path="ggplot2.html"><a href="ggplot2.html#geom_stars"><i class="fa fa-check"></i><b>10.2</b> <code>geom_stars</code></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="interactive.html"><a href="interactive.html"><i class="fa fa-check"></i><b>11</b> Interactive Maps</a></li>
<li class="part"><span><b>III Models for Spatial Data</b></span></li>
<li class="chapter" data-level="12" data-path="pointpatterns.html"><a href="pointpatterns.html"><i class="fa fa-check"></i><b>12</b> Point Pattern Analysis</a></li>
<li class="chapter" data-level="13" data-path="manipulating-attributes-summarise-aggregate-union-sample.html"><a href="manipulating-attributes-summarise-aggregate-union-sample.html"><i class="fa fa-check"></i><b>13</b> Manipulating attributes: summarise, aggregate, union, sample</a></li>
<li class="chapter" data-level="14" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html"><i class="fa fa-check"></i><b>14</b> Area Data and Spatial Autocorrelation</a><ul>
<li class="chapter" data-level="14.1" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>14.1</b> Spatial autocorrelation</a></li>
<li class="chapter" data-level="14.2" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#spatial-weight-matrices"><i class="fa fa-check"></i><b>14.2</b> Spatial weight matrices</a></li>
<li class="chapter" data-level="14.3" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#measures-of-spatial-autocorrelation"><i class="fa fa-check"></i><b>14.3</b> Measures of spatial autocorrelation</a></li>
<li class="chapter" data-level="14.4" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#spatial-heterogeneity"><i class="fa fa-check"></i><b>14.4</b> Spatial heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="spatial-regression.html"><a href="spatial-regression.html"><i class="fa fa-check"></i><b>15</b> Spatial Regression</a><ul>
<li class="chapter" data-level="15.1" data-path="spatial-regression.html"><a href="spatial-regression.html#spatial-regression-with-spatial-weights"><i class="fa fa-check"></i><b>15.1</b> Spatial regression with spatial weights</a></li>
<li class="chapter" data-level="15.2" data-path="spatial-regression.html"><a href="spatial-regression.html#estimators"><i class="fa fa-check"></i><b>15.2</b> Estimators</a></li>
<li class="chapter" data-level="15.3" data-path="spatial-regression.html"><a href="spatial-regression.html#implementation-details"><i class="fa fa-check"></i><b>15.3</b> Implementation details</a></li>
<li class="chapter" data-level="15.4" data-path="spatial-regression.html"><a href="spatial-regression.html#markov-random-field-and-multilevel-models-with-spatial-weights"><i class="fa fa-check"></i><b>15.4</b> Markov random field and multilevel models with spatial weights</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="movement-data.html"><a href="movement-data.html"><i class="fa fa-check"></i><b>16</b> Movement data</a></li>
<li class="chapter" data-level="17" data-path="statistical-modelling-of-spatiotemporal-data.html"><a href="statistical-modelling-of-spatiotemporal-data.html"><i class="fa fa-check"></i><b>17</b> Statistical modelling of spatiotemporal data</a></li>
<li class="chapter" data-level="18" data-path="sp-and-raster.html"><a href="sp-and-raster.html"><i class="fa fa-check"></i><b>18</b> sp and raster</a><ul>
<li class="chapter" data-level="18.1" data-path="sp-and-raster.html"><a href="sp-and-raster.html#links-and-differences-between-sf-and-sp"><i class="fa fa-check"></i><b>18.1</b> links and differences between sf and sp</a></li>
<li class="chapter" data-level="18.2" data-path="sp-and-raster.html"><a href="sp-and-raster.html#migration-packages"><i class="fa fa-check"></i><b>18.2</b> migration packages</a></li>
<li class="chapter" data-level="18.3" data-path="sp-and-raster.html"><a href="sp-and-raster.html#raster-stars-and-sf"><i class="fa fa-check"></i><b>18.3</b> raster, stars and sf</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i>R basics</a><ul>
<li class="chapter" data-level="18.4" data-path="r-basics.html"><a href="r-basics.html#pipes"><i class="fa fa-check"></i><b>18.4</b> Pipes</a></li>
<li class="chapter" data-level="18.5" data-path="r-basics.html"><a href="r-basics.html#data-structures"><i class="fa fa-check"></i><b>18.5</b> Data structures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="featureattributes" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Attributes, Up- and Downscaling</h1>
<p>Feature <em>attributes</em> refer to the properties of features (“things”)
that do not describe the feature’s geometry. Feature attributes can
be <em>derived</em> from geometry (e.g. length of a <code>LINESTRING</code>, area
of a <code>POLYGON</code>) but they can also refer to completely different
properties, such as</p>
<ul>
<li>the name of a street or a county,</li>
<li>the number of people living in a country,</li>
<li>the type of a road</li>
<li>the soil type in a polygon from a soil map.</li>
<li>the opening hours of a shop</li>
<li>the body weight or heart beat of an animal</li>
<li>the NO<span class="math inline">\(_2\)</span> concentration measured at an air quality monitoring station</li>
</ul>
<p>Although temporal properties of features are no less fundamental
than their spatial properties, the <em>simple feature access</em> standard
does not give time a similar role as space; more on that in chapter
<a href="raster.html#raster">6</a>.</p>
<p>Spatial data science software implementing simple features typically
organizes data in tables that contain both geometries and attributes
for features; this is true for <code>geopandas</code> in Python, <code>PostGIS</code>
tables in PostgreSQL, and <code>sf</code> objects in R. The geometric
operations described in the previous chapter (<a href="geometries.html#opgeom">3.2</a>)
operate on geometries <em>only</em>, and may occasionally yield attributes
(predicates or measures), but will not modify attributes present.</p>
<p>In all these cases, while manipulating geometries, attribute <em>values</em>
remain unmodified. At first sight, that looks rather harmless. But
if we look into a simple case of replacing a county boundary with
a county centroid, we may see a warning is emitted:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb80-2" title="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb80-3" title="3"><span class="kw">system.file</span>(<span class="st">&quot;gpkg/nc.gpkg&quot;</span>, <span class="dt">package=</span><span class="st">&quot;sf&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb80-4" title="4"><span class="st">    </span><span class="kw">read_sf</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb80-5" title="5"><span class="st">    </span><span class="kw">st_transform</span>(<span class="dv">32119</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb80-6" title="6"><span class="st">    </span><span class="kw">select</span>(BIR74, SID74, NAME) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb80-7" title="7"><span class="st">    </span><span class="kw">st_centroid</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb80-8" title="8"><span class="st">    </span><span class="kw">head</span>(<span class="dt">n =</span> <span class="dv">1</span>) -&gt;<span class="st"> </span>x <span class="co"># save as x</span></a></code></pre></div>
<pre><code># Warning in st_centroid.sf(.): st_centroid assumes attributes are constant over
# geometries of x</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">st_geometry</span>(x)[[<span class="dv">1</span>]]</a></code></pre></div>
<pre><code># POINT (385605 3e+05)</code></pre>
<p>This warning is justified for the first two variables shown (total
births and number of SID disease cases, 1974) which, as such, are
<em>not associated with</em> a feature whose geometry is <code>POINT (385605.4 300303.5)</code>. The third variable, <code>NAME</code> is however still the county
name for the point indicated, but the point geometry no longer <em>is</em>
the county geometry.</p>
<p>In section <a href="intro.html#support">1.6</a> we already described that for non-point
geometries, feature attribute values may either have <em>point support</em>,
meaning that the value applies to <em>every point</em>, or they may have
<em>block support</em>, meaning that the value <em>summarizes all points</em>
in the geometry. More complex options, e.g. inbetween these two
extremes, may also occur. This chapter will describe different
ways in which an attribute may relate to the geometry, its
consequences on analysing such data, and ways to derive attribute
data for different geometries (up- and downscaling).</p>
<div id="agr" class="section level2">
<h2><span class="header-section-number">5.1</span> Attribute-geometry relationships</h2>
<p>Changing the feature geometry without changing the feature attributes
does change the <em>feature</em>, since the feature is characterised by
the combination of geometry and attributes. Can we, ahead of time,
predict whether the resulting feature will still meaningfully relate
to the attribute data when we replace all geometries for instance
with their convex hull or centroid? It depends.</p>
<p>Take the example of a road, represented by a <code>LINESTRING</code>, which has
an attribute property <em>road width</em> equal to 10 m. What can we say about
the road width of an arbitray subsectin of this road? That depends
on whether the attribute road length describes, for instance the
road width everywhere, meaning that road width is constant along the
road, or whether it describes an aggregate property, such as minimum
or average road width. In case of the minimum, for an arbitrary
subsection of the road one could still argue that the minimum
road width must be at least as large as the minimum road width for
the whole segment, but it may no longer be <em>the minimum</em> for that
subsection. This gives us two “types” for the attribute-geometry
relationship (<strong>AGR</strong>):</p>
<ul>
<li><strong>constant</strong> the attribute value is valid everywhere in or over the geometry</li>
<li><strong>aggregate</strong> the attribute is an aggregate, a summary value over the geometry</li>
</ul>
<p>For polygon data, typical examples of <strong>constant</strong> AGR are</p>
<ul>
<li>land use for a land use polygon</li>
<li>rock units or geologic strata in a geological map</li>
<li>soil type in a soil map</li>
<li>elevation class in a elevation map that shows elevation as classes</li>
<li>climate zone in a climate zone map</li>
</ul>
<p>Typical examples for the <strong>aggregate</strong> AGR are</p>
<ul>
<li>population, either as number of persons or as population density</li>
<li>other socio-economic variables, summarised by area</li>
<li>total emission of pollutants by region</li>
<li>block mean NO<span class="math inline">\(_2\)</span> concentrations, as e.g. obtained by block kriging or a dispersion model that predicts areal means</li>
</ul>
<p>A third type of AGR is that where an attribute identifies a feature
geometry. The example above is county <code>NAME</code>: the name identifies
the county, and is still the county <code>NAME</code> for any sub-area.</p>
<ul>
<li><strong>identity</strong> the attribute value uniquely identifies the geometry
as a whole, there are no other geometries with the same value</li>
</ul>
<p>For arbitrary sub-areas, the attribute will lose the <strong>identity</strong>
property but becomes a <strong>constant</strong> attribute. An example is:</p>
<ul>
<li>any point inside a county is still part of the county and must have
the same value for county name, but it does not longer represent the
(entire) geometry corresponding to that county.</li>
</ul>
<p>The challenge here is that spatial information (ignoring time for
simplicity) belongs to different phenomena types <span class="citation">(e.g. Scheider et al. <a href="#ref-scheider2016">2016</a>)</span>,
including</p>
<ul>
<li><strong>fields</strong>: where over <em>continuous</em> space, every location corresponds to a single value, e.g. elevation</li>
<li><strong>objects</strong>: found a <em>discrete</em> set of locations, e.g. houses or persons</li>
<li><strong>aggregations</strong>: e.g. sums, totals, averages of fields, or spatial densities of objects</li>
</ul>
<p>but that different spatial geometry types (points, lines, polygons,
raster cells) do not correspond to either of these:</p>
<ul>
<li>points may refer to samples of fields (air quality) or locations of objects</li>
<li>lines may be used for objects (roads) or contours of a field</li>
<li>raster pixels and polygons may reflect fields of a categorical
variable such as land use (<em>coverage</em>), but also aggregates such
as population density</li>
</ul>
<p>Properly specifying attribute-geometry relationships, and warning
against their absence or cases when change of geometry (support)
implies a change of information can help avoiding a large class of
common spatial data analysis mistakes <span class="citation">(Stasch et al. <a href="#ref-stasch2014">2014</a>)</span> associated with
the support of spatial data.</p>
</div>
<div id="spatial-join" class="section level2">
<h2><span class="header-section-number">5.2</span> Spatial join</h2>
<p>In regular (left, right or inner) joins, <em>joined</em> records from a
pair of tables are reported when one or more selected attributes
match (are identical) in both tables. A spatial join is similar,
but the criterion to join records is not equality of attributes but
a spatial predicate. This leaves a wide variety of options in order
to define <em>spatially</em> matching records, using binary predicates
listed in section <a href="geometries.html#de9im">3.2.2</a>. The concepts of “left”, “right”,
“inner” or “full” joins remain identical to the non-spatial join
as the options for handling records that have no spatial match.</p>
<p>When using spatial joins, each record may have many matched records,
yielding a large result table. A way to reduce this complexity may
be to select the matching record with the largest overlap with the
target geometry. An example of this is shown (visually) in figure
<a href="featureattributes.html#fig:largest">5.1</a>.</p>

<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="co"># example of largest = TRUE:</span></a>
<a class="sourceLine" id="cb84-2" title="2">nc &lt;-<span class="st"> </span><span class="kw">st_transform</span>(<span class="kw">read_sf</span>(<span class="kw">system.file</span>(<span class="st">&quot;shape/nc.shp&quot;</span>, <span class="dt">package=</span><span class="st">&quot;sf&quot;</span>)), <span class="dv">2264</span>)</a>
<a class="sourceLine" id="cb84-3" title="3">gr =<span class="st"> </span><span class="kw">st_sf</span>(</a>
<a class="sourceLine" id="cb84-4" title="4">         <span class="dt">label =</span> <span class="kw">apply</span>(<span class="kw">expand.grid</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, LETTERS[<span class="dv">10</span><span class="op">:</span><span class="dv">1</span>])[,<span class="dv">2</span><span class="op">:</span><span class="dv">1</span>], <span class="dv">1</span>, paste0, <span class="dt">collapse =</span> <span class="st">&quot; &quot;</span>),</a>
<a class="sourceLine" id="cb84-5" title="5">         <span class="dt">geom =</span> <span class="kw">st_make_grid</span>(nc))</a>
<a class="sourceLine" id="cb84-6" title="6">gr<span class="op">$</span>col =<span class="st"> </span><span class="kw">sf.colors</span>(<span class="dv">10</span>, <span class="dt">categorical =</span> <span class="ot">TRUE</span>, <span class="dt">alpha =</span> <span class="fl">.3</span>)</a>
<a class="sourceLine" id="cb84-7" title="7"><span class="co"># cut, to check, NA&#39;s work out:</span></a>
<a class="sourceLine" id="cb84-8" title="8">gr =<span class="st"> </span>gr[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>),]</a>
<a class="sourceLine" id="cb84-9" title="9"><span class="kw">suppressWarnings</span>(nc_j &lt;-<span class="st"> </span><span class="kw">st_join</span>(nc, gr, <span class="dt">largest =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb84-10" title="10"><span class="co"># the two datasets:</span></a>
<a class="sourceLine" id="cb84-11" title="11">opar =<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">mar =</span> <span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb84-12" title="12"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(nc_j))</a>
<a class="sourceLine" id="cb84-13" title="13"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(gr), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> gr<span class="op">$</span>col)</a>
<a class="sourceLine" id="cb84-14" title="14"><span class="kw">text</span>(<span class="kw">st_coordinates</span>(<span class="kw">st_centroid</span>(<span class="kw">st_geometry</span>(gr))), <span class="dt">labels =</span> gr<span class="op">$</span>label)</a>
<a class="sourceLine" id="cb84-15" title="15"><span class="co"># the joined dataset:</span></a>
<a class="sourceLine" id="cb84-16" title="16"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(nc_j), <span class="dt">border =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">col =</span> nc_j<span class="op">$</span>col)</a>
<a class="sourceLine" id="cb84-17" title="17"><span class="kw">text</span>(<span class="kw">st_coordinates</span>(<span class="kw">st_centroid</span>(<span class="kw">st_geometry</span>(nc_j))), <span class="dt">labels =</span> nc_j<span class="op">$</span>label, <span class="dt">cex =</span> <span class="fl">.8</span>)</a>
<a class="sourceLine" id="cb84-18" title="18"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(gr), <span class="dt">border =</span> <span class="st">&#39;green&#39;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb84-19" title="19"><span class="kw">par</span>(opar)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:largest"></span>
<img src="sds_files/figure-html/largest-1.png" alt="example of st_join with largest = TRUE: the label of the polygon in the top figure with the largest intersection with polygons in the bottom figure is assigned to the polygons of the bottom figure" width="60%" />
<p class="caption">
Figure 5.1: example of <code>st_join</code> with <code>largest = TRUE</code>: the label of the polygon in the top figure with the largest intersection with polygons in the bottom figure is assigned to the polygons of the bottom figure
</p>
</div>
<p>Another way to reduce the result set is to aggregate, after a join,
all matching records, and union their geometry; this will now be
discussed.</p>
</div>
<div id="aggregating-and-summarising" class="section level2">
<h2><span class="header-section-number">5.3</span> Aggregating and Summarising</h2>
<p>Aggregating records in a table (or <code>data.frame</code>) involves two
steps</p>
<ul>
<li>grouping records based on a grouping predicate, and</li>
<li>applying an aggregation function to the attribute values of a
group to summarize them into a single number.</li>
</ul>
<p>In SQL, this looks for instance like</p>
<pre><code>SELECT GroupID, SUM(population) FROM table GROUP BY GroupID;</code></pre>
<p>indicating that the aggregation function (<code>SUM</code>) and the grouping
predicate (<code>region</code>). R package <code>dplyr</code> for instance offers two
functions: <code>group_by</code> which specifies the group membership of records
and <code>summarize</code> which computes data summaries (such as <code>sum</code> or
<code>mean</code>) for each of the groups. R (base) function <code>aggregate</code> does
both in a single function that takes the data table, the grouping
predicate(s) and the aggregation function.</p>
<p>An example for the North Caroline counties is shown in figure
<a href="featureattributes.html#fig:ncaggregation">5.2</a>. Here, we group counties by their position
(according to the quadrant in which the county centroid is with
respect to geographical coordinate <code>POINT(-79, 35.5)</code>) and
count the number of disease cases per group. The result shows that
the geometries of the resulting group have been unioned (section
<a href="geometries.html#bintrans">3.2.6</a>), which is necessary because the <code>MULTIPOLYGON</code>
formed by just putting all the county geometries together would
have many duplicate boundaries, and hence not be <em>valid</em> (section
<a href="geometries.html#valid">3.1.2</a>).</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">nc &lt;-<span class="st"> </span><span class="kw">read_sf</span>(<span class="kw">system.file</span>(<span class="st">&quot;gpkg/nc.gpkg&quot;</span>, <span class="dt">package=</span><span class="st">&quot;sf&quot;</span>))</a>
<a class="sourceLine" id="cb86-2" title="2"><span class="kw">plot</span>(nc[<span class="st">&quot;SID74&quot;</span>], <span class="dt">axes =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb86-3" title="3"><span class="kw">sf_use_s2</span>(<span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb86-4" title="4"><span class="co"># encode quadrant by two logicals:</span></a>
<a class="sourceLine" id="cb86-5" title="5">nc<span class="op">$</span>lng =<span class="st"> </span><span class="kw">st_coordinates</span>(<span class="kw">st_centroid</span>(<span class="kw">st_geometry</span>(nc)))[,<span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">-79</span></a>
<a class="sourceLine" id="cb86-6" title="6">nc<span class="op">$</span>lat =<span class="st"> </span><span class="kw">st_coordinates</span>(<span class="kw">st_centroid</span>(<span class="kw">st_geometry</span>(nc)))[,<span class="dv">2</span>] <span class="op">&gt;</span><span class="st"> </span><span class="fl">35.5</span></a>
<a class="sourceLine" id="cb86-7" title="7">nc.grp =<span class="st"> </span><span class="kw">aggregate</span>(nc[<span class="st">&quot;SID74&quot;</span>], <span class="kw">list</span>(nc<span class="op">$</span>lng, nc<span class="op">$</span>lat), sum)</a>
<a class="sourceLine" id="cb86-8" title="8"><span class="kw">plot</span>(nc.grp[<span class="st">&quot;SID74&quot;</span>], <span class="dt">axes =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:ncaggregation"></span>
<img src="sds_files/figure-html/ncaggregation-1.png" alt="top: SID74 disease cases by county, bottom: summed values by county quadrant, county polygons unioned by county quadrant" width="672" /><img src="sds_files/figure-html/ncaggregation-2.png" alt="top: SID74 disease cases by county, bottom: summed values by county quadrant, county polygons unioned by county quadrant" width="672" />
<p class="caption">
Figure 5.2: top: SID74 disease cases by county, bottom: summed values by county quadrant, county polygons unioned by county quadrant
</p>
</div>
<p>Plotting collated county polygons is technically not a problem, but
for this case would raise the wrong suggestion that the group sums
relate to the counties, and not the group of counties. Subsequent
geometrical operations on such invalid polygon collections would
however fail (and require a <code>union</code> or <code>make_valid</code> first).</p>
<p>One particular property of aggregation in this way is that each
record is assigned to a single group; this has the advantage that
the sum of the group-wise sums equals the sum of the ungrouped data:
for variables that reflect <em>amount</em>, nothing gets lost and nothing
is added. The newly formed geometry is the result of unioning the
geometries of the records.</p>
<p>When we need an aggregate for a new area that is <em>not</em> a union
of the geometries for a group of records, and we use a spatial
predicate then we may end up with a case where records are matched to
multiple groups. When taking the rectangles of figure <a href="#largest"><strong>??</strong></a>
as the target areas, and we sum for each rectangle the disease cases
of the counties that <em>intersect</em> with the rectangle, the sum of these
will be much larger:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">nc &lt;-<span class="st"> </span><span class="kw">st_transform</span>(nc, <span class="dv">2264</span>)</a>
<a class="sourceLine" id="cb87-2" title="2">a =<span class="st"> </span><span class="kw">aggregate</span>(nc[<span class="st">&quot;SID74&quot;</span>], gr, sum)</a>
<a class="sourceLine" id="cb87-3" title="3"><span class="kw">c</span>(<span class="dt">sid74_sum_counties =</span> <span class="kw">sum</span>(nc<span class="op">$</span>SID74), <span class="dt">sid74_sum_rectangles =</span> <span class="kw">sum</span>(a<span class="op">$</span>SID74, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code>#   sid74_sum_counties sid74_sum_rectangles 
#                  667                 2282</code></pre>
<p>Choosing another predicate, e.g. <em>contains</em> or <em>covers</em> would on
the contrary result in much smaller values, because many counties
are not contained by <em>any</em> the target geometries. However, there are
a few cases where this approach might be good or satisfactory:</p>
<ul>
<li>when we want to aggregate <code>POINT</code> geometries by a set of polygons,
and all points are contained by a polygon. If points fall on a
shared boundary than they are assigned to both polygons (this is
the case for DE-9IM-based GEOS library; the s2geometry library has
the option to define polygons as “semi-open”, which implies that
points are assigned to single polygons when the polygons form a
coverage)</li>
<li>when aggregating many very small polygons or raster pixels over
larger areas, e.g. averaging altitude from 30 m resolution raster
over North Carolina counties, the error made by multiple matches
may be insignificant.</li>
</ul>
<p>A more comprehensive approach to aggregating spatial data associated
to areas to larger, arbitrary shaped areas is by using area-weighted
interpolation.</p>
</div>
<div id="area-weighted" class="section level2">
<h2><span class="header-section-number">5.4</span> Area-weighted interpolation</h2>
<p>When we want to combine geometries and attributes of two datasets
such that we get attribute values of a source dataset summarised for
the geometries of a target, where source and target geometries are
unrelated, area-weighted interpolation may be a simple approach. In
effect, it considers the area of overlap of the source and target
geometries, and uses that to weight the source attribute values into
the target value <span class="citation">(Goodchild and Lam <a href="#ref-goodchild">1980</a>; Do, Thomas-Agnan, and Vanhems <a href="#ref-thomas">2015</a><a href="#ref-thomas">a</a>, <a href="#ref-do">2015</a><a href="#ref-do">b</a>)</span>. Here, we follow the
notation of <span class="citation">(Do, Thomas-Agnan, and Vanhems <a href="#ref-do">2015</a><a href="#ref-do">b</a>)</span>.</p>
<p>Area-weighted interpolation computes for each of <span class="math inline">\(q\)</span> spatial target
areas <span class="math inline">\(T_j\)</span> a weighted average from the values <span class="math inline">\(Y_i\)</span> corresponding
to the <span class="math inline">\(p\)</span> spatial source areas <span class="math inline">\(S_i\)</span>,</p>
<p><span class="math display" id="eq:aw">\[\begin{equation}
\hat{Y}_j(T_j) = \sum_{i=1}^p w_{ij} Y_i(S_i)
\tag{5.1}
\end{equation}\]</span></p>
<p>where the <span class="math inline">\(w_{ij}\)</span> depend on the amount of overlap of <span class="math inline">\(T_j\)</span> and
<span class="math inline">\(S_i\)</span>, <span class="math inline">\(A_{ij} = T_j \cap S_i\)</span>.</p>
<p>Different options exist for choosing weights, including methods
using external variables (e.g. dasymetric mapping, <span class="citation">(Mennis <a href="#ref-mennis">2003</a>)</span>).
Two simple approaches for computing weights that do not use external
variables arise, depending on whether the variable <span class="math inline">\(Z\)</span> is <em>intensive</em>
or <em>extensive</em>.</p>
<div id="spatially-extensive-and-intensive-variables" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Spatially extensive and intensive variables</h3>
<p>An example of an extensive variable is <em>population count</em>. It
is associated with an area, and if that area is cut into smaller
areas, the population count is split accordingly: not necessary
proportional to area, because population is rarely uniform, but split
in such a way that the sum of the population count for the smaller
areas equals that of the total. An example of a related variable
that is <em>intensive</em> is population density. If an an area is split
into smaller areas, population density is not split similarly:
the sum of the population densities for the smaller areas is a
meaningless measure, as opposed to the average of the population
densities which will be similar to the density of the total area.</p>
<p>Extensive variables correspond to amounts, associated with a physical
size (length, area, volume); for spatially extensive variables,
if the area a value corresponds to is cut in parts, the values
associated with the sub-area are split accordingly. In other words:
the value is proportional to the support. Intensive variables are
variables that do not have values proportional to support: if the
area is split, values may vary but <em>on average</em> remain the same.
The corresponding example of an intensive variable is <em>population
density</em>: when we split an area into sub-areas, the sub-areas either
have identical population densities (in case population is uniformly
distributed) or, more realistically, have <em>varying</em> population
densities that by necessity are both higher and lower than the
density of the total area.</p>
<p>When we assume that the extensive variable <span class="math inline">\(Y\)</span> is uniformly
distributed over space, the value <span class="math inline">\(Y_{ij}\)</span>, derived from <span class="math inline">\(Y_i\)</span>
for a sub-area of <span class="math inline">\(S_i\)</span>, <span class="math inline">\(A_{ij} = T_j \cap S_i\)</span> of <span class="math inline">\(S_i\)</span> is</p>
<p><span class="math display">\[\hat{Y}_{ij}(A_{ij}) = \frac{|A_{ij}|}{|S_i|} Y_i(S_i)\]</span></p>
<p>where <span class="math inline">\(|\cdot|\)</span> denotes the spatial area.
For estimating <span class="math inline">\(Y_j(T_j)\)</span> we sum all the elements over area <span class="math inline">\(T_j\)</span>:</p>
<p><span class="math display" id="eq:awextensive">\[\begin{equation}
\hat{Y}_j(T_j) = \sum_{i=1}^p \frac{|A_{ij}|}{|S_i|} Y_i(S_i)
\tag{5.2}
\end{equation}\]</span></p>
<p>For an intensive variable, under the assumption that the variable
has a constant value over each area <span class="math inline">\(S_i\)</span>, the estimate for a
sub-area equals that of the total,</p>
<p><span class="math display">\[\hat{Y}_{ij} = Y_i(S_i)\]</span></p>
<p>and we can estimate the value of <span class="math inline">\(Y\)</span> for a new spatial unit <span class="math inline">\(T_j\)</span>
by an area-weighted average of the source values:</p>
<p><span class="math display" id="eq:awintensive">\[\begin{equation}
\hat{Y}_j(T_j) = \sum_{i=1}^p \frac{|A_{ij}|}{|T_j|} Y_i(S_i)
\tag{5.3}
\end{equation}\]</span></p>
</div>
<div id="dasymetric-mapping" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Dasymetric mapping</h3>
<p>Dasymetric mapping distributes variables, such as population,
known at a course spatial aggregation level over finer spatial
units by using other variables that are associated with population
distribution, such as land use, building density, or road density.
The simplest approach to dasymetric mapping is obtained for
extensive variables, where the ratio <span class="math inline">\(|A_{ij}| / |S_i|\)</span> in
<a href="featureattributes.html#eq:awextensive">(5.2)</a> is replaced by the ratio of another extensive
variable <span class="math inline">\(X_{ij}(S_{ij})/X_i(S_i)\)</span>, which has to be known for both
the intersecting regions <span class="math inline">\(S_{ij}\)</span> and the source regions <span class="math inline">\(S_i\)</span>.
<span class="citation">(Do, Thomas-Agnan, and Vanhems <a href="#ref-do">2015</a><a href="#ref-do">b</a>)</span> discuss several alternatives for intensive <span class="math inline">\(Y\)</span> and/or <span class="math inline">\(X\)</span>,
and cases where <span class="math inline">\(X\)</span> is known for other areas.</p>
</div>
<div id="aggregation-and-disaggregation" class="section level3">
<h3><span class="header-section-number">5.4.3</span> Aggregation and disaggregation</h3>
<p>The application of areal interpolation using <a href="featureattributes.html#eq:aw">(5.1)</a> with
its realisations for extensive <a href="featureattributes.html#eq:awextensive">(5.2)</a> and intensive
<a href="featureattributes.html#eq:awintensive">(5.3)</a> variables allows moving information from any
source area <span class="math inline">\(S_i\)</span> to any target area <span class="math inline">\(T_j\)</span> as long as the two areas
have some overlap. This means that one can go arbitrarily to much
larger units (aggregation) or to much smaller units (disaggregation).
Of course this makes only sense to the extent that the assumptions
hold: over the source regions extensive variables need to be
uniformly distributed and intensive variables need to have constant
value.</p>
<p>The ultimate disaggregation involves retrieving (extracting)
point values from line or area data. For this, we cannot work with
equations <a href="featureattributes.html#eq:awextensive">(5.2)</a> or <a href="featureattributes.html#eq:awintensive">(5.3)</a> because
<span class="math inline">\(|A_{ij}| = 0\)</span> for points, but under the assumption of having a
constant value over the geometry, for intensive variables the value
<span class="math inline">\(Y_i(S_i)\)</span> can be assigned to points as long as all points can be
uniquely assigned to a single source area <span class="math inline">\(S_i\)</span>. For polygon data,
this implies that <span class="math inline">\(Y\)</span> needs to be a coverage variable (section
<a href="geometries.html#coverages">3.4</a>).</p>
<p>In cases where values associated with areas are <strong>aggregate</strong> values
over the area, the assumptions made by area-weighted interpolation
or dasymetric mapping – uniformity or constant values over the
source areas – are highly unrealistic. In such cases, these simple
approaches still be reasonable approximations, for instance when</p>
<ul>
<li>the source and target area are nearly identical</li>
<li>the variability inside source units is very small, and the variable
is nearly uniform or constant.</li>
</ul>
<p>In other cases, results obtained using these methods are merely
consequences of unjustified assumptions. Statistical aggregation
methods that can estimate quantities for larger regions from points
or smaller regions include</p>
<ul>
<li>design-based methods, which require that a probability sample is
available from the target region, with known inclusion probabilities, and</li>
<li>model-based methods, which assume a random field model with spatially
correlated values (block kriging, section <a href="#blockkriging"><strong>??</strong></a>).</li>
</ul>
<p>Alternative disaggregation methods include</p>
<ul>
<li>deterministic, smoothing-based approaches: kernel- or spline-based
smoothing methods <span class="citation">(Tobler <a href="#ref-toblerpyc">1979</a>; Martin <a href="#ref-martin89">1989</a>)</span></li>
<li>statistical, model-based approaches: area-to-area and area-to-point
kriging <span class="citation">(Kyriakidis <a href="#ref-kyriakidis04">2004</a>)</span>, see section <a href="#areatopoint"><strong>??</strong></a></li>
</ul>
</div>
</div>
<div id="exercises-2" class="section level2">
<h2><span class="header-section-number">5.5</span> Exercises</h2>
<ul>
<li>Add a variable to the <code>nc</code> dataset by <code>nc$State = "North Carolina"</code>. Which value should you attach to this variable for the attribute-geometry relationship (agr)?</li>
<li>Create a new <code>sf</code> object from the geometry obtained by <code>st_union(nc)</code>, and assign <code>"North Carolina"</code> to the variable <code>State</code>. Which <code>agr</code> can you now assign to this attribute variable?</li>
<li>Use <code>st_area</code> to add a variable with name <code>area</code> to <code>nc</code>. Compare the <code>area</code> and <code>AREA</code> variables in the <code>nc</code> dataset. What are the units of <code>AREA</code>? Are the two linearly related? If there are discrepancies, what could be the cause?</li>
<li>Is the <code>area</code> variable intensive or extensive? Is its agr equal to <code>constant</code>, <code>identity</code> or <code>aggregate</code>?</li>
<li>Find the name of the county that contains <code>POINT(-78.34046 35.017)</code></li>
<li>Find the names of all counties with boundaries that touch county <code>Sampson</code>.</li>
<li>List the names of all counties that are less than 50 km away from county <code>Sampson</code>.</li>
</ul>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-thomas">
<p>Do, Van Huyen, Christine Thomas-Agnan, and Anne Vanhems. 2015a. “Accuracy of Areal Interpolation Methods for Count Data.” <em>Spatial Statistics</em> 14: 412–38. <a href="https://doi.org/10.1016/j.spasta.2015.07.005">https://doi.org/10.1016/j.spasta.2015.07.005</a>.</p>
</div>
<div id="ref-do">
<p>Do, Van Huyen, Christine Thomas-Agnan, and Anne Vanhems. 2015b. “Spatial Reallocation of Areal Data: A Review.” <em>Rev. Econ. Rég. Urbaine</em> 1/2: 27–58. <a href="https://www.tse-fr.eu/sites/default/files/medias/doc/wp/mad/wp_tse_397_v2.pdf">https://www.tse-fr.eu/sites/default/files/medias/doc/wp/mad/wp_tse_397_v2.pdf</a>.</p>
</div>
<div id="ref-goodchild">
<p>Goodchild, Michael F, and Nina Siu Ngan Lam. 1980. <em>Areal Interpolation: A Variant of the Traditional Spatial Problem</em>. Department of Geography, University of Western Ontario London, ON, Canada.</p>
</div>
<div id="ref-kyriakidis04">
<p>Kyriakidis, P.C. 2004. “A Geostatistical Framework for Areal-to-Point Spatial Interpolation.” <em>Geographical Analysis</em> 36 (3): 259–89.</p>
</div>
<div id="ref-martin89">
<p>Martin, D. 1989. “Mapping Population Data from Zone Centroid Locations.” <em>Transactions of the Institute of British Geographers, New Series</em> 14 (1): 90–97.</p>
</div>
<div id="ref-mennis">
<p>Mennis, Jeremy. 2003. “Generating Surface Models of Population Using Dasymetric Mapping.” <em>The Professional Geographer</em> 55 (1): 31–42.</p>
</div>
<div id="ref-scheider2016">
<p>Scheider, Simon, Benedikt Gräler, Edzer Pebesma, and Christoph Stasch. 2016. “Modeling Spatiotemporal Information Generation.” <em>International Journal of Geographical Information Science</em> 30 (10): 1980–2008. <a href="https://doi.org/10.1080/13658816.2016.1151520">https://doi.org/10.1080/13658816.2016.1151520</a>.</p>
</div>
<div id="ref-stasch2014">
<p>Stasch, Christoph, Simon Scheider, Edzer Pebesma, and Werner Kuhn. 2014. “Meaningful Spatial Prediction and Aggregation.” <em>Environmental Modelling &amp; Software</em> 51: 149–65. <a href="https://doi.org/10.1016/j.envsoft.2013.09.006">https://doi.org/10.1016/j.envsoft.2013.09.006</a>.</p>
</div>
<div id="ref-toblerpyc">
<p>Tobler, W.R. 1979. “Smooth Pycnophylactic Interpolation for Geographical Regions.” <em>Journal of the American Statistical Association</em> 74 (367): 519–30.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spherical.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="raster.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/edzer/sdsr/edit/master/05-Attributes.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
