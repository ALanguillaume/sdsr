<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Plotting spatial data | Spatial Data Science</title>
  <meta name="description" content="description_xx" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Plotting spatial data | Spatial Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="description_xx" />
  <meta name="github-repo" content="edzer/sdsr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Plotting spatial data | Spatial Data Science" />
  
  <meta name="twitter:description" content="description_xx" />
  

<meta name="author" content="Edzer Pebesma, Roger Bivand" />


<meta name="date" content="2021-02-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rs.html"/>
<link rel="next" href="plot.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/fgb.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/flatgeobuf-geojson.min.js"></script>
<script src="libs/chromajs-2.1.0/chroma.min.js"></script>
<link id="_-BIR74-1-attachment" rel="attachment" href="libs/_-BIR74-0.0.1/_-BIR74_layer.fgb"/>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Spatial Data</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#a-first-map"><i class="fa fa-check"></i><b>1.1</b> A first map</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#coordinate-reference-systems"><i class="fa fa-check"></i><b>1.2</b> Coordinate reference systems</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#raster-and-vector-data"><i class="fa fa-check"></i><b>1.3</b> Raster and vector data</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#raster-types"><i class="fa fa-check"></i><b>1.4</b> Raster types</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#time-series-arrays-data-cubes"><i class="fa fa-check"></i><b>1.5</b> Time series, arrays, data cubes</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#support"><i class="fa fa-check"></i><b>1.6</b> Support</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#spatial-data-science-software"><i class="fa fa-check"></i><b>1.7</b> Spatial data science software</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cs.html"><a href="cs.html"><i class="fa fa-check"></i><b>2</b> Coordinate systems</a><ul>
<li class="chapter" data-level="2.1" data-path="cs.html"><a href="cs.html#polar-and-cartesian-coordinates"><i class="fa fa-check"></i><b>2.1</b> Polar and Cartesian coordinates</a></li>
<li class="chapter" data-level="2.2" data-path="cs.html"><a href="cs.html#ellipsoidal-coordinates"><i class="fa fa-check"></i><b>2.2</b> Ellipsoidal coordinates</a></li>
<li class="chapter" data-level="2.3" data-path="cs.html"><a href="cs.html#projected-coordinates"><i class="fa fa-check"></i><b>2.3</b> Projected coordinates</a></li>
<li class="chapter" data-level="2.4" data-path="cs.html"><a href="cs.html#distances"><i class="fa fa-check"></i><b>2.4</b> Distances</a></li>
<li class="chapter" data-level="2.5" data-path="cs.html"><a href="cs.html#bounded"><i class="fa fa-check"></i><b>2.5</b> Bounded and unbounded spaces</a></li>
<li class="chapter" data-level="2.6" data-path="cs.html"><a href="cs.html#time"><i class="fa fa-check"></i><b>2.6</b> Time</a></li>
<li class="chapter" data-level="2.7" data-path="cs.html"><a href="cs.html#exercises-1"><i class="fa fa-check"></i><b>2.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geometries.html"><a href="geometries.html"><i class="fa fa-check"></i><b>3</b> Geometries</a><ul>
<li class="chapter" data-level="3.1" data-path="geometries.html"><a href="geometries.html#simple-feature-geometries"><i class="fa fa-check"></i><b>3.1</b> Simple feature geometries</a></li>
<li class="chapter" data-level="3.2" data-path="geometries.html"><a href="geometries.html#opgeom"><i class="fa fa-check"></i><b>3.2</b> Operations on geometries</a></li>
<li class="chapter" data-level="3.3" data-path="geometries.html"><a href="geometries.html#precision"><i class="fa fa-check"></i><b>3.3</b> Precision</a></li>
<li class="chapter" data-level="3.4" data-path="geometries.html"><a href="geometries.html#coverages"><i class="fa fa-check"></i><b>3.4</b> Coverages: tesselations and rasters</a></li>
<li class="chapter" data-level="3.5" data-path="geometries.html"><a href="geometries.html#networks"><i class="fa fa-check"></i><b>3.5</b> Networks</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spherical.html"><a href="spherical.html"><i class="fa fa-check"></i><b>4</b> Spherical Geometries</a><ul>
<li class="chapter" data-level="4.1" data-path="spherical.html"><a href="spherical.html#straight-lines"><i class="fa fa-check"></i><b>4.1</b> Straight lines</a></li>
<li class="chapter" data-level="4.2" data-path="spherical.html"><a href="spherical.html#ring-direction"><i class="fa fa-check"></i><b>4.2</b> Ring direction</a></li>
<li class="chapter" data-level="4.3" data-path="spherical.html"><a href="spherical.html#full-polygon"><i class="fa fa-check"></i><b>4.3</b> Full polygon</a></li>
<li class="chapter" data-level="4.4" data-path="spherical.html"><a href="spherical.html#bounding-box-rectangle-and-cap"><i class="fa fa-check"></i><b>4.4</b> Bounding box, rectangle, and cap</a></li>
<li class="chapter" data-level="4.5" data-path="spherical.html"><a href="spherical.html#validity-on-the-sphere"><i class="fa fa-check"></i><b>4.5</b> Validity on the sphere</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="featureattributes.html"><a href="featureattributes.html"><i class="fa fa-check"></i><b>5</b> Attributes, Up- and Downscaling</a><ul>
<li class="chapter" data-level="5.1" data-path="featureattributes.html"><a href="featureattributes.html#agr"><i class="fa fa-check"></i><b>5.1</b> Attribute-geometry relationships</a></li>
<li class="chapter" data-level="5.2" data-path="featureattributes.html"><a href="featureattributes.html#spatial-join"><i class="fa fa-check"></i><b>5.2</b> Spatial join</a></li>
<li class="chapter" data-level="5.3" data-path="featureattributes.html"><a href="featureattributes.html#aggregating-and-summarising"><i class="fa fa-check"></i><b>5.3</b> Aggregating and Summarising</a></li>
<li class="chapter" data-level="5.4" data-path="featureattributes.html"><a href="featureattributes.html#area-weighted-interpolation"><i class="fa fa-check"></i><b>5.4</b> Area-weighted interpolation</a></li>
<li class="chapter" data-level="5.5" data-path="featureattributes.html"><a href="featureattributes.html#exercises-2"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="raster.html"><a href="raster.html"><i class="fa fa-check"></i><b>6</b> Raster and vector datacubes</a><ul>
<li class="chapter" data-level="6.1" data-path="raster.html"><a href="raster.html#package-stars"><i class="fa fa-check"></i><b>6.1</b> Package <code>stars</code></a></li>
<li class="chapter" data-level="6.2" data-path="raster.html"><a href="raster.html#raster-data"><i class="fa fa-check"></i><b>6.2</b> Raster data</a></li>
<li class="chapter" data-level="6.3" data-path="raster.html"><a href="raster.html#datacubes"><i class="fa fa-check"></i><b>6.3</b> Vector Datacubes</a></li>
<li class="chapter" data-level="6.4" data-path="raster.html"><a href="raster.html#exercises-3"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="updownscaling.html"><a href="updownscaling.html"><i class="fa fa-check"></i><b>7</b> Up- and Downscaling</a></li>
<li class="chapter" data-level="8" data-path="rs.html"><a href="rs.html"><i class="fa fa-check"></i><b>8</b> Reference Systems</a><ul>
<li class="chapter" data-level="8.1" data-path="rs.html"><a href="rs.html#units"><i class="fa fa-check"></i><b>8.1</b> Units of measurement</a></li>
<li class="chapter" data-level="8.2" data-path="rs.html"><a href="rs.html#temporal-reference-systems"><i class="fa fa-check"></i><b>8.2</b> Temporal Reference Systems</a></li>
<li class="chapter" data-level="8.3" data-path="rs.html"><a href="rs.html#crs"><i class="fa fa-check"></i><b>8.3</b> Coordinate Reference Systems</a></li>
</ul></li>
<li class="part"><span><b>II R for Spatial Data Science</b></span></li>
<li class="chapter" data-level="9" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>9</b> Plotting spatial data</a><ul>
<li class="chapter" data-level="9.1" data-path="plotting.html"><a href="plotting.html#transform"><i class="fa fa-check"></i><b>9.1</b> Every plot is a projection</a></li>
<li class="chapter" data-level="9.2" data-path="plotting.html"><a href="plotting.html#plotting-points-lines-polygons-grid-cells"><i class="fa fa-check"></i><b>9.2</b> Plotting points, lines, polygons, grid cells</a></li>
<li class="chapter" data-level="9.3" data-path="plotting.html"><a href="plotting.html#classintervals"><i class="fa fa-check"></i><b>9.3</b> Color palettes and class intervals</a></li>
<li class="chapter" data-level="9.4" data-path="plotting.html"><a href="plotting.html#poles-and-datelines"><i class="fa fa-check"></i><b>9.4</b> Poles and datelines</a></li>
<li class="chapter" data-level="9.5" data-path="plotting.html"><a href="plotting.html#graticule"><i class="fa fa-check"></i><b>9.5</b> Graticules and other navigation aids</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="plot.html"><a href="plot.html"><i class="fa fa-check"></i><b>10</b> Base and grid plots</a><ul>
<li class="chapter" data-level="10.1" data-path="plot.html"><a href="plot.html#base-plots"><i class="fa fa-check"></i><b>10.1</b> Base plots</a></li>
<li class="chapter" data-level="10.2" data-path="plot.html"><a href="plot.html#combining-base-plots"><i class="fa fa-check"></i><b>10.2</b> Combining base plots</a></li>
<li class="chapter" data-level="10.3" data-path="plot.html"><a href="plot.html#grid-plots-and-viewports"><i class="fa fa-check"></i><b>10.3</b> Grid plots and viewports</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>11</b> ggplot2</a><ul>
<li class="chapter" data-level="11.1" data-path="ggplot2.html"><a href="ggplot2.html#geom_sf"><i class="fa fa-check"></i><b>11.1</b> <code>geom_sf</code></a></li>
<li class="chapter" data-level="11.2" data-path="ggplot2.html"><a href="ggplot2.html#geom_stars"><i class="fa fa-check"></i><b>11.2</b> <code>geom_stars</code></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="interactive.html"><a href="interactive.html"><i class="fa fa-check"></i><b>12</b> Interactive Maps</a></li>
<li class="part"><span><b>III Models for Spatial Data</b></span></li>
<li class="chapter" data-level="13" data-path="pointpatterns.html"><a href="pointpatterns.html"><i class="fa fa-check"></i><b>13</b> Point Pattern Analysis</a></li>
<li class="chapter" data-level="14" data-path="manipulating-attributes-summarise-aggregate-union-sample.html"><a href="manipulating-attributes-summarise-aggregate-union-sample.html"><i class="fa fa-check"></i><b>14</b> Manipulating attributes: summarise, aggregate, union, sample</a></li>
<li class="chapter" data-level="15" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html"><i class="fa fa-check"></i><b>15</b> Area Data and Spatial Autocorrelation</a><ul>
<li class="chapter" data-level="15.1" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>15.1</b> Spatial autocorrelation</a></li>
<li class="chapter" data-level="15.2" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#spatial-weight-matrices"><i class="fa fa-check"></i><b>15.2</b> Spatial weight matrices</a></li>
<li class="chapter" data-level="15.3" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#measures-of-spatial-autocorrelation"><i class="fa fa-check"></i><b>15.3</b> Measures of spatial autocorrelation</a></li>
<li class="chapter" data-level="15.4" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#spatial-heterogeneity"><i class="fa fa-check"></i><b>15.4</b> Spatial heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="spatial-regression.html"><a href="spatial-regression.html"><i class="fa fa-check"></i><b>16</b> Spatial Regression</a><ul>
<li class="chapter" data-level="16.1" data-path="spatial-regression.html"><a href="spatial-regression.html#spatial-regression-with-spatial-weights"><i class="fa fa-check"></i><b>16.1</b> Spatial regression with spatial weights</a></li>
<li class="chapter" data-level="16.2" data-path="spatial-regression.html"><a href="spatial-regression.html#estimators"><i class="fa fa-check"></i><b>16.2</b> Estimators</a></li>
<li class="chapter" data-level="16.3" data-path="spatial-regression.html"><a href="spatial-regression.html#implementation-details"><i class="fa fa-check"></i><b>16.3</b> Implementation details</a></li>
<li class="chapter" data-level="16.4" data-path="spatial-regression.html"><a href="spatial-regression.html#markov-random-field-and-multilevel-models-with-spatial-weights"><i class="fa fa-check"></i><b>16.4</b> Markov random field and multilevel models with spatial weights</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="movement-data.html"><a href="movement-data.html"><i class="fa fa-check"></i><b>17</b> Movement data</a></li>
<li class="chapter" data-level="18" data-path="statistical-modelling-of-spatiotemporal-data.html"><a href="statistical-modelling-of-spatiotemporal-data.html"><i class="fa fa-check"></i><b>18</b> Statistical modelling of spatiotemporal data</a></li>
<li class="chapter" data-level="19" data-path="sp-and-raster.html"><a href="sp-and-raster.html"><i class="fa fa-check"></i><b>19</b> sp and raster</a><ul>
<li class="chapter" data-level="19.1" data-path="sp-and-raster.html"><a href="sp-and-raster.html#links-and-differences-between-sf-and-sp"><i class="fa fa-check"></i><b>19.1</b> links and differences between sf and sp</a></li>
<li class="chapter" data-level="19.2" data-path="sp-and-raster.html"><a href="sp-and-raster.html#migration-packages"><i class="fa fa-check"></i><b>19.2</b> migration packages</a></li>
<li class="chapter" data-level="19.3" data-path="sp-and-raster.html"><a href="sp-and-raster.html#raster-stars-and-sf"><i class="fa fa-check"></i><b>19.3</b> raster, stars and sf</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i>R basics</a><ul>
<li class="chapter" data-level="19.4" data-path="r-basics.html"><a href="r-basics.html#pipes"><i class="fa fa-check"></i><b>19.4</b> Pipes</a></li>
<li class="chapter" data-level="19.5" data-path="r-basics.html"><a href="r-basics.html#data-structures"><i class="fa fa-check"></i><b>19.5</b> Data structures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Plotting spatial data</h1>
<p>Together with timelines, maps belong to the most powerful graphs,
perhaps because we can immediately relate where we are, or have
been, on the space of the plot. Two recent books on visualisation
<span class="citation">(Healy <a href="#ref-Healy">2018</a>, <span class="citation">@Wilke</span>)</span> contain chapters on visualising geospatial data or
maps. Here, we will not try to preach the do’s and don’ts of maps,
but rather point out a number of possibilities how to do things,
point out challenges along the way and ways to mitigate them.</p>
<div id="transform" class="section level2">
<h2><span class="header-section-number">9.1</span> Every plot is a projection</h2>
<p>The world is round, but plotting devices are flat. As mentioned
in section <a href="rs.html#projections">8.3.1</a>, any time we visualise, in any
way, the world on a flat device, we project: we convert angular,
geographic coordinates into Cartesian coordinates. This includes
the cases where we think we “do nothing” (figure <a href="plotting.html#fig:world">9.1</a>,
left), or where show the world “as it is”, e.g. as seen from space
(figure <a href="plotting.html#fig:world">9.1</a>, right).</p>
<div class="figure" style="text-align: center"><span id="fig:world"></span>
<img src="sds_files/figure-html/world-1.png" alt="Earth country boundaries; left: mapping long/lat to x and y; right: as seen from space" width="672" />
<p class="caption">
Figure 9.1: Earth country boundaries; left: mapping long/lat to x and y; right: as seen from space
</p>
</div>
<p>The left plot of figure <a href="plotting.html#fig:world">9.1</a> was obtained by</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb126-2" title="2"><span class="kw">library</span>(rnaturalearth)</a>
<a class="sourceLine" id="cb126-3" title="3">w &lt;-<span class="st"> </span><span class="kw">ne_countries</span>(<span class="dt">scale =</span> <span class="st">&quot;medium&quot;</span>, <span class="dt">returnclass =</span> <span class="st">&quot;sf&quot;</span>)</a>
<a class="sourceLine" id="cb126-4" title="4"><span class="kw">plot</span>(<span class="kw">st_geometry</span>(w))</a></code></pre></div>
<p>and we see that this is the default projection for data with geographic coordinates, as indicated by</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">st_crs</span>(w)</a>
<a class="sourceLine" id="cb127-2" title="2"><span class="co"># Coordinate Reference System:</span></a>
<a class="sourceLine" id="cb127-3" title="3"><span class="co">#   User input: EPSG:4326 </span></a>
<a class="sourceLine" id="cb127-4" title="4"><span class="co">#   wkt:</span></a>
<a class="sourceLine" id="cb127-5" title="5"><span class="co"># GEOGCRS[&quot;WGS 84&quot;,</span></a>
<a class="sourceLine" id="cb127-6" title="6"><span class="co">#     DATUM[&quot;World Geodetic System 1984&quot;,</span></a>
<a class="sourceLine" id="cb127-7" title="7"><span class="co">#         ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,</span></a>
<a class="sourceLine" id="cb127-8" title="8"><span class="co">#             LENGTHUNIT[&quot;metre&quot;,1]]],</span></a>
<a class="sourceLine" id="cb127-9" title="9"><span class="co">#     PRIMEM[&quot;Greenwich&quot;,0,</span></a>
<a class="sourceLine" id="cb127-10" title="10"><span class="co">#         ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],</span></a>
<a class="sourceLine" id="cb127-11" title="11"><span class="co">#     CS[ellipsoidal,2],</span></a>
<a class="sourceLine" id="cb127-12" title="12"><span class="co">#         AXIS[&quot;geodetic latitude (Lat)&quot;,north,</span></a>
<a class="sourceLine" id="cb127-13" title="13"><span class="co">#             ORDER[1],</span></a>
<a class="sourceLine" id="cb127-14" title="14"><span class="co">#             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],</span></a>
<a class="sourceLine" id="cb127-15" title="15"><span class="co">#         AXIS[&quot;geodetic longitude (Lon)&quot;,east,</span></a>
<a class="sourceLine" id="cb127-16" title="16"><span class="co">#             ORDER[2],</span></a>
<a class="sourceLine" id="cb127-17" title="17"><span class="co">#             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],</span></a>
<a class="sourceLine" id="cb127-18" title="18"><span class="co">#     USAGE[</span></a>
<a class="sourceLine" id="cb127-19" title="19"><span class="co">#         SCOPE[&quot;Horizontal component of 3D system.&quot;],</span></a>
<a class="sourceLine" id="cb127-20" title="20"><span class="co">#         AREA[&quot;World.&quot;],</span></a>
<a class="sourceLine" id="cb127-21" title="21"><span class="co">#         BBOX[-90,-180,90,180]],</span></a>
<a class="sourceLine" id="cb127-22" title="22"><span class="co">#     ID[&quot;EPSG&quot;,4326]]</span></a></code></pre></div>
<p>The projection taken here is the equirectangular (or equidistant
cylindrical) projection, which maps longitude and latitude linear
to the x and y axis, keeping an aspect ratio of 1. Were we to do
this for smaller areas not on the equator, it makes sense to choose
a plot ratio such that one distance unit E-W equals one distance
unit N-S on the center of the plotted area.</p>
<p>We can also carry out this projection before plotting. Say we want to
do this for Germany, then after loading the (rough) country outline,
we use <code>st_transform</code> to project:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1">DE =<span class="st"> </span><span class="kw">st_geometry</span>(<span class="kw">ne_countries</span>(<span class="dt">country =</span> <span class="st">&quot;germany&quot;</span>, <span class="dt">returnclass =</span> <span class="st">&quot;sf&quot;</span>))</a>
<a class="sourceLine" id="cb128-2" title="2">DE.eqc =<span class="st"> </span><span class="kw">st_transform</span>(DE, <span class="st">&quot;+proj=eqc +lat_ts=51.14 +lon_0=90w&quot;</span>)</a></code></pre></div>
<p><code>st_transform</code> takes an <code>sf</code> or <code>sfc</code> object, and as second
argument the projection. This can either be a number of a known EPSG
projection, e.g. listed at <a href="http://spatialreference.org/ref/epsg/" class="uri">http://spatialreference.org/ref/epsg/</a> ,
or a string describing the projection (<code>+proj=...</code>) with further
parameters. The parameter here is <code>lat_ts</code>, the latitude of true
scale (i.e., one length unit N-S equals one length unit E-W),
which was here chosen as the middle of the bounding box latitudes</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="kw">mean</span>(<span class="kw">st_bbox</span>(DE)[<span class="kw">c</span>(<span class="st">&quot;ymin&quot;</span>, <span class="st">&quot;ymax&quot;</span>)])</a>
<a class="sourceLine" id="cb129-2" title="2"><span class="co"># [1] 51.1</span></a></code></pre></div>
<p>When we now plot both maps (figure <a href="plotting.html#fig:eqc">9.2</a>), they look the
same up to their values along the axes: degrees for geographic (left),
and metres for Cartesian coordinates.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb130-2" title="2"><span class="kw">plot</span>(DE, <span class="dt">axes =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb130-3" title="3"><span class="kw">plot</span>(DE.eqc, <span class="dt">axes =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:eqc"></span>
<img src="sds_files/figure-html/eqc-1.png" alt="Germany in equidistant cylindrical projection: left with degrees, right with metres along the axes" width="60%" />
<p class="caption">
Figure 9.2: Germany in equidistant cylindrical projection: left with degrees, right with metres along the axes
</p>
</div>
<div id="what-is-a-good-projection-for-my-data" class="section level3">
<h3><span class="header-section-number">9.1.1</span> What is a good projection for my data?</h3>
<p>There is unfortunately no silver bullet here. Projections that
maintain all distances do not exist; only globes do. The most
used projections try to preserve</p>
<ul>
<li>areas (equal area),</li>
<li>directions (conformal, e.g. Mercator),</li>
<li>some properties of distances (e.g. equirectangular preserves distances along meridians, azimuthal equidistant preserves distances to a central point)</li>
</ul>
<p>or some compromise of these. Parameters of projections decide what
is shown in the center of a map and what on the fringes, which
areas are up and which are down, and which areas are most enlarged.
All these choices are in the end political decisions.</p>
<p>It is often entertaining and at times educational to play around with
the different projections and understand their consequences. When
the primary purpose of the map however is not to entertain or educate
projection varieties, it may be preferrable to choose a well-known or
less surprising projection, and move the discussion which projection
should be preferred to a decision process on its own.</p>
</div>
<div id="does-projection-always-work" class="section level3">
<h3><span class="header-section-number">9.1.2</span> Does projection always work?</h3>
<p>No. Look for instance at the figure <a href="plotting.html#fig:world">9.1</a>, right. Countries
like the USA are half out-of-sight. Where is the California coast
line drawn?</p>
<p>The PROJ string used here was <code>"+proj=ortho +lat_0=30 +lon_0=-10"</code>
and we can easily check what happens to a polygon that crosses the
visible area by setting both parameters to 0:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1">sq =<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">89</span>,<span class="dv">0</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">89</span>,<span class="dv">1</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">91</span>,<span class="dv">1</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">91</span>,<span class="dv">0</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">89</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb131-2" title="2">pol =<span class="st"> </span><span class="kw">st_sfc</span>(<span class="kw">st_polygon</span>(<span class="kw">list</span>(sq)), <span class="dt">crs =</span> <span class="dv">4326</span>)</a>
<a class="sourceLine" id="cb131-3" title="3">(<span class="dt">pol.o =</span> <span class="kw">st_transform</span>(pol, <span class="st">&quot;+proj=ortho +lat_0=0 +lon_0=0&quot;</span>))[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb131-4" title="4"><span class="co"># POLYGON ((-6377166 0, -6376201 110569, -6377166 0))</span></a>
<a class="sourceLine" id="cb131-5" title="5"><span class="kw">st_is_valid</span>(pol.o, <span class="dt">NA_on_exception=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb131-6" title="6"><span class="co"># Error in CPL_geos_is_valid(x, as.logical(NA_on_exception)): Evaluation error: IllegalArgumentException: Invalid number of points in LinearRing found 3 - must be 0 or &gt;= 4.</span></a></code></pre></div>
<p>where we see that the polygon is not nicely cut along the visibility
line, but that the invisible points are simply dropped. This
leads in this case to an invalid geometry, and may in the case of
<a href="plotting.html#fig:world">9.1</a> lead to straight lines that do not follow the map
border circle.</p>
<p>How was figure <a href="plotting.html#fig:world">9.1</a> created? By using a rather ugly
script that used a projected half-sphere circle to first cooky-cut
the part of the countries that would
remain visible on this projection. The
<a href="https://github.com/r-spatial/sf/blob/master/demo/twitter.R">script</a>
is available, and so is its
<a href="https://gist.github.com/edzer/9c5c24434ffcaf42917796a98c4dd9a6">output</a>.</p>
</div>
</div>
<div id="plotting-points-lines-polygons-grid-cells" class="section level2">
<h2><span class="header-section-number">9.2</span> Plotting points, lines, polygons, grid cells</h2>
<p>Since maps are just a special form of plots of statistical data,
the usual rules hold. Frequently occuring challenges include:</p>
<ul>
<li>polygons may be very small, and vanish when plotted</li>
<li>depending on the data, polygons for different features may well
overlap, and be visible only partially; using transparent fill
colors may help indentify them</li>
<li>when points are plotted with symbols, they may easily overlap and be hidden; density maps (chapter <a href="pointpatterns.html#pointpatterns">13</a>) may be more helpful</li>
<li>lines may be hard to read when coloured and may overlap regardless line width</li>
</ul>
<p>When plotting polygons filled with colors, one has the choice to plot
polygon boundaries, or to suppress these. If polygon boundaries draw
too much attention, an alternative is to colour them in a grey tone,
or another color that doesn’t interfere with the fill colors. When
suppressing boundaries entirely, polygons with (nearly) identical
colors will melt together. If the property indicating the fill
color is constant over the region, such as land cover type, this is
OK. If the property is an aggregation, the region over which it was
aggregated gets lost. Especially for extensive variables, e.g. the
amount of people living in a polygon, this strongly misleads. But
even with polygon boundaries, using filled polygons for such
variables may not be a good idea.</p>
<p>The use of continuous color scales for continuously varying variables
may look attractive, but is often more fancy than useful:</p>
<ul>
<li>it impracticle to match a color on the map with a legend value</li>
<li>colors ramps often stretch non-linearly over the value range</li>
</ul>
<p>Only for cases where the identification of values is less important
than the continuity of the map, such as the coloring of a high
resolution digital terrain model, it does serve its goal.</p>
</div>
<div id="classintervals" class="section level2">
<h2><span class="header-section-number">9.3</span> Color palettes and class intervals</h2>
<p>FIXME: discuss color palettes, continuous/categorical, diverging, RColorBrewer, viridis, …</p>
<p>When plotting continuous geometry attributes using a limited set
of colors (or symbols), classes need to be made from the data. The
R package <code>classInt</code> <span class="citation">(R. Bivand <a href="#ref-R-classInt">2020</a><a href="#ref-R-classInt">a</a>)</span> provides a number of methods to
do so. Using it is quite simple:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="kw">library</span>(classInt)</a>
<a class="sourceLine" id="cb132-2" title="2"><span class="co"># set.seed(1) needed ?</span></a>
<a class="sourceLine" id="cb132-3" title="3">r =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb132-4" title="4">(cI &lt;-<span class="st"> </span><span class="kw">classIntervals</span>(r))</a>
<a class="sourceLine" id="cb132-5" title="5"><span class="co"># style: quantile</span></a>
<a class="sourceLine" id="cb132-6" title="6"><span class="co">#   one of 1.49e+10 possible partitions of this variable into 8 classes</span></a>
<a class="sourceLine" id="cb132-7" title="7"><span class="co">#   [-2.61,-1.26)  [-1.26,-0.356) [-0.356,-0.131)  [-0.131,0.091)   [0.091,0.433) </span></a>
<a class="sourceLine" id="cb132-8" title="8"><span class="co">#              13              12              13              12              12 </span></a>
<a class="sourceLine" id="cb132-9" title="9"><span class="co">#   [0.433,0.623)    [0.623,1.11)     [1.11,2.76] </span></a>
<a class="sourceLine" id="cb132-10" title="10"><span class="co">#              13              12              13</span></a>
<a class="sourceLine" id="cb132-11" title="11">cI<span class="op">$</span>brks</a>
<a class="sourceLine" id="cb132-12" title="12"><span class="co"># [1] -2.612 -1.257 -0.356 -0.131  0.091  0.433  0.623  1.113  2.755</span></a></code></pre></div>
<p>and it takes argument <code>n</code> for the number of intervals, and a <code>style</code>
that can be one of “fixed”, “sd”, “equal”, “pretty”, “quantile”,
“kmeans”, “hclust”, “bclust”, “fisher” or “jenks”. Style “pretty”
may not obey <code>n</code>; if <code>n</code> is missing, ‘nclass.Sturges’ is used;
two other methods are available for choosing <code>n</code> automatically. If
the number of observations is greater than 3000, a 10% sample is used
to create the breaks for “fisher” and “jenks”.</p>
</div>
<div id="poles-and-datelines" class="section level2">
<h2><span class="header-section-number">9.4</span> Poles and datelines</h2>
<p>Given the linestring</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1">(<span class="dt">ls =</span> <span class="kw">st_sfc</span>(<span class="kw">st_linestring</span>(<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="op">-</span><span class="fl">179.5</span>, <span class="dv">52</span>), <span class="kw">c</span>(<span class="fl">179.5</span>, <span class="dv">52</span>))), <span class="dt">crs =</span> <span class="dv">4326</span>))</a>
<a class="sourceLine" id="cb133-2" title="2"><span class="co"># Geometry set for 1 feature </span></a>
<a class="sourceLine" id="cb133-3" title="3"><span class="co"># geometry type:  LINESTRING</span></a>
<a class="sourceLine" id="cb133-4" title="4"><span class="co"># dimension:      XY</span></a>
<a class="sourceLine" id="cb133-5" title="5"><span class="co"># bbox:           xmin: -180 ymin: 52 xmax: 180 ymax: 52</span></a>
<a class="sourceLine" id="cb133-6" title="6"><span class="co"># geographic CRS: WGS 84</span></a>
<a class="sourceLine" id="cb133-7" title="7"><span class="co"># LINESTRING (-180 52, 180 52)</span></a></code></pre></div>
<p>How long a distance does it span? Let’s see:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="kw">st_length</span>(ls)</a>
<a class="sourceLine" id="cb134-2" title="2"><span class="co"># 68677 [m]</span></a></code></pre></div>
<p>which seems sensible. But does <code>ls</code> actually intersect with the dateline?</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1">dateline =<span class="st"> </span><span class="kw">st_sfc</span>(<span class="kw">st_linestring</span>(<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">180</span>, <span class="dv">51</span>), <span class="kw">c</span>(<span class="dv">180</span>, <span class="dv">53</span>))), <span class="dt">crs =</span> <span class="dv">4326</span>)</a>
<a class="sourceLine" id="cb135-2" title="2"><span class="kw">st_intersects</span>(ls, dateline)</a>
<a class="sourceLine" id="cb135-3" title="3"><span class="co"># although coordinates are longitude/latitude, st_intersects assumes that they are planar</span></a>
<a class="sourceLine" id="cb135-4" title="4"><span class="co"># Sparse geometry binary predicate list of length 1, where the predicate was `intersects&#39;</span></a>
<a class="sourceLine" id="cb135-5" title="5"><span class="co">#  1: (empty)</span></a></code></pre></div>
<p>… it seems not? How can this be? The warning said it all: if
<code>ls</code> is not in spherical coordinates, it means it follows the 52th
parallel, crossing <code>(0, 52)</code> half way. This is as if we drew a straight
line between the two points on the left figure of <a href="plotting.html#fig:world">9.1</a>,
almost across the complete 52N parallel.</p>
<p>Where do these inconsistencies come from? The software <code>sf</code> is built
upon (see the C/C++ libraries box in figure <a href="intro.html#fig:gdal-fig-nodetails">1.6</a>) is a
GIS software stack that originally targeted flat, 2D geometries. The
simple feature standard assumes straight lines between points,
but great circle segments are not straight.</p>
<p>The functions that deal with spherical geometry, such as
<code>st_length</code>, use PostGIS extensions in liblwgeom that were
added later on to PostGIS, without rewriting the entire
geometry core for geographic coordinates. More recent systems,
including Google’s S2<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, BigQuery
GIS<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> and Ubers
H3<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> were written from scratch with global
data in mind, and work exclusively with geographic coordinates.</p>
<div id="st_wrap_dateline" class="section level3">
<h3><span class="header-section-number">9.4.1</span> <code>st_wrap_dateline</code></h3>
<p>The <code>st_wrap_dateline</code> function can be convenient,</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1">(<span class="dt">ls.w =</span> <span class="kw">st_wrap_dateline</span>(ls))[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb136-2" title="2"><span class="co"># MULTILINESTRING ((-180 52, -180 52), (180 52, 180 52))</span></a></code></pre></div>
<p>as it cuts any geometry crossing the dateline into MULTI-geometries
of which the sub-geometries touch on, but no longer cross the
dateline. This is in particular convenient for plotting geographic
coordinates using naive approaches such as that of figure
<a href="plotting.html#fig:world">9.1</a> left, where they would have crossed the entire
plotting area. Note that by cutting the line at <code>(180,52)</code>,
<code>st_wrap_dateline</code> does not follow a great circle; for this, it
should be preceded by <code>st_segmentize</code>, as e.g. in</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1">(<span class="dt">ls.w2 =</span> <span class="kw">st_wrap_dateline</span>(<span class="kw">st_segmentize</span>(ls, units<span class="op">::</span><span class="kw">set_units</span>(<span class="dv">30</span>, km))))[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb137-2" title="2"><span class="co"># MULTILINESTRING ((-180 52, -180 52, -180 52, -180 52), (180 52, 180 52, 180 52))</span></a></code></pre></div>
<p>Also note that bounding boxes like</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1"><span class="kw">st_bbox</span>(ls.w)</a>
<a class="sourceLine" id="cb138-2" title="2"><span class="co"># xmin ymin xmax ymax </span></a>
<a class="sourceLine" id="cb138-3" title="3"><span class="co"># -180   52  180   52</span></a></code></pre></div>
<p>simply take the coordinate ranges, and are pretty much meaningless
as descriptors of the extent of a geometry for geometries that
cross the dateline.</p>
<p>Similar notions hold for the poles; a polygon enclosing the North pole</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1">pole =<span class="st"> </span><span class="kw">st_sfc</span>(<span class="kw">st_polygon</span>(<span class="kw">list</span>(<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">80</span>), <span class="kw">c</span>(<span class="dv">120</span>,<span class="dv">80</span>), <span class="kw">c</span>(<span class="dv">240</span>,<span class="dv">80</span>), <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">80</span>)))), <span class="dt">crs =</span> <span class="dv">4326</span>)</a></code></pre></div>
<p>does not include the pole</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1"><span class="kw">st_intersects</span>(pole, <span class="kw">st_sfc</span>(<span class="kw">st_point</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">90</span>)), <span class="dt">crs =</span> <span class="dv">4326</span>))</a>
<a class="sourceLine" id="cb140-2" title="2"><span class="co"># although coordinates are longitude/latitude, st_intersects assumes that they are planar</span></a>
<a class="sourceLine" id="cb140-3" title="3"><span class="co"># Sparse geometry binary predicate list of length 1, where the predicate was `intersects&#39;</span></a>
<a class="sourceLine" id="cb140-4" title="4"><span class="co">#  1: (empty)</span></a></code></pre></div>
<p>(Cartesian interpretation) but has a positive area</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1"><span class="kw">st_area</span>(pole)</a>
<a class="sourceLine" id="cb141-2" title="2"><span class="co"># 1.63e+12 [m^2]</span></a></code></pre></div>
<p>indicating again a geographic interpretation.</p>
</div>
</div>
<div id="graticule" class="section level2">
<h2><span class="header-section-number">9.5</span> Graticules and other navigation aids</h2>
<p>Graticules are lines on a map that follow constant latitude or
longitude values. On figure <a href="plotting.html#fig:world">9.1</a> left they are drawn
in grey. Graticules are often drawn in maps to give reference where
something is. In our first map in figure <a href="intro.html#fig:first-map">1.1</a> we can
read that the area plotted is near 35<span class="math inline">\(^o\)</span> North and 80<span class="math inline">\(^o\)</span> West.
Had we plotted the lines in the projected coordinate system, they
would have been straight and their actual numbers would not have
been very informative, apart from giving an interpretation of size
or distances when the unit is known, and familiar to the map reader.
Graticules, by that, also shed light on which projection
was used: equirectangular or Mercator projections will have straight
vertical and horizontal lines, conic projections have straight but
diverging meridians, equal area may have curved meridians</p>
<p>The real navigation aid on figure <a href="plotting.html#fig:world">9.1</a> and most other
maps are geographical features like the state outline, country
outlines, coast lines, rivers, roads, railways and so on. If these
are added sparsely and sufficiently, graticules can as well be
omitted. In such cases, maps look good without axes, tics, and labels,
leaving up a lot of plotting space to be filled with actual map data.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-classInt">
<p>Bivand, Roger. 2020a. <em>ClassInt: Choose Univariate Class Intervals</em>. <a href="https://CRAN.R-project.org/package=classInt">https://CRAN.R-project.org/package=classInt</a>.</p>
</div>
<div id="ref-Healy">
<p>Healy, Kieran. 2018. <em>Data Visualization, a Practical Introduction</em>. Princeton University Press. <a href="http://socviz.co/index.html">http://socviz.co/index.html</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p><a href="http://s2geometry.io/" class="uri">http://s2geometry.io/</a><a href="plotting.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p><a href="https://cloud.google.com/bigquery/docs/gis-intro" class="uri">https://cloud.google.com/bigquery/docs/gis-intro</a><a href="plotting.html#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p><a href="https://eng.uber.com/h3/" class="uri">https://eng.uber.com/h3/</a><a href="plotting.html#fnref3" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/edzer/sdsr/edit/master/09-Plotting.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["sds.pdf", "sds.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
