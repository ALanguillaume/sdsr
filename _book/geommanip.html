<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Spatial Data Science with R</title>
  <meta name="description" content="description_xx">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Spatial Data Science with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="description_xx" />
  <meta name="github-repo" content="edzer/sdsr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Spatial Data Science with R" />
  
  <meta name="twitter:description" content="description_xx" />
  

<meta name="author" content="Edzer Pebesma, Roger Bivand">


<meta name="date" content="2018-10-18">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="raster.html">
<link rel="next" href="featureattributes.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.1.17/leaflet-providers.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.1/leaflet-providers-plugin.js"></script>
<script src="libs/mapPane-0.0.1/map-pane.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<link href="libs/PopupTable-0.0.1/popup.css" rel="stylesheet" />


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial Data Science with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Spatial Data</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#a-first-map"><i class="fa fa-check"></i><b>1.1</b> A first map</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#reading"><i class="fa fa-check"></i><b>1.2</b> Reading and writing</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="coordinate-systems.html"><a href="coordinate-systems.html"><i class="fa fa-check"></i><b>2</b> Coordinate systems</a><ul>
<li class="chapter" data-level="2.1" data-path="coordinate-systems.html"><a href="coordinate-systems.html#cartesian-and-geodetic-coordinates"><i class="fa fa-check"></i><b>2.1</b> Cartesian and geodetic coordinates</a></li>
<li class="chapter" data-level="2.2" data-path="coordinate-systems.html"><a href="coordinate-systems.html#ellipsoidal-coordinates"><i class="fa fa-check"></i><b>2.2</b> Ellipsoidal coordinates</a></li>
<li class="chapter" data-level="2.3" data-path="coordinate-systems.html"><a href="coordinate-systems.html#distances"><i class="fa fa-check"></i><b>2.3</b> Distances</a></li>
<li class="chapter" data-level="2.4" data-path="coordinate-systems.html"><a href="coordinate-systems.html#bounded-spaces"><i class="fa fa-check"></i><b>2.4</b> Bounded spaces</a></li>
<li class="chapter" data-level="2.5" data-path="coordinate-systems.html"><a href="coordinate-systems.html#time"><i class="fa fa-check"></i><b>2.5</b> Time</a></li>
<li class="chapter" data-level="2.6" data-path="coordinate-systems.html"><a href="coordinate-systems.html#exercises-1"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geometries.html"><a href="geometries.html"><i class="fa fa-check"></i><b>3</b> Geometries</a><ul>
<li class="chapter" data-level="3.1" data-path="geometries.html"><a href="geometries.html#simple-feature-geometry-types"><i class="fa fa-check"></i><b>3.1</b> Simple feature geometry types</a></li>
<li class="chapter" data-level="3.2" data-path="geometries.html"><a href="geometries.html#simple-features-in-sf"><i class="fa fa-check"></i><b>3.2</b> Simple features in <code>sf</code></a></li>
<li class="chapter" data-level="3.3" data-path="geometries.html"><a href="geometries.html#geomraster"><i class="fa fa-check"></i><b>3.3</b> Tesselations: coverages, rasters</a></li>
<li class="chapter" data-level="3.4" data-path="geometries.html"><a href="geometries.html#networks"><i class="fa fa-check"></i><b>3.4</b> Networks</a></li>
<li class="chapter" data-level="3.5" data-path="geometries.html"><a href="geometries.html#geometries-on-the-sphere"><i class="fa fa-check"></i><b>3.5</b> Geometries on the sphere</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="raster.html"><a href="raster.html"><i class="fa fa-check"></i><b>4</b> Raster data and datacubes</a><ul>
<li class="chapter" data-level="4.1" data-path="raster.html"><a href="raster.html#package-stars"><i class="fa fa-check"></i><b>4.1</b> Package <code>stars</code></a></li>
<li class="chapter" data-level="4.2" data-path="raster.html"><a href="raster.html#raster-data"><i class="fa fa-check"></i><b>4.2</b> Raster data</a></li>
<li class="chapter" data-level="4.3" data-path="raster.html"><a href="raster.html#datacubes"><i class="fa fa-check"></i><b>4.3</b> Datacubes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="geommanip.html"><a href="geommanip.html"><i class="fa fa-check"></i><b>5</b> Geometric Manipulations</a><ul>
<li class="chapter" data-level="5.1" data-path="geommanip.html"><a href="geommanip.html#unary-operations"><i class="fa fa-check"></i><b>5.1</b> Unary Operations</a></li>
<li class="chapter" data-level="5.2" data-path="geommanip.html"><a href="geommanip.html#binary-operations"><i class="fa fa-check"></i><b>5.2</b> Binary Operations</a></li>
<li class="chapter" data-level="5.3" data-path="geommanip.html"><a href="geommanip.html#n-ary-operations"><i class="fa fa-check"></i><b>5.3</b> N-ary Operations</a></li>
<li class="chapter" data-level="5.4" data-path="geommanip.html"><a href="geommanip.html#precision"><i class="fa fa-check"></i><b>5.4</b> Precision</a></li>
<li class="chapter" data-level="5.5" data-path="geommanip.html"><a href="geommanip.html#longlat"><i class="fa fa-check"></i><b>5.5</b> Warnings for longitude/latitude geometries</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="featureattributes.html"><a href="featureattributes.html"><i class="fa fa-check"></i><b>6</b> Feature attributes</a><ul>
<li class="chapter" data-level="6.1" data-path="featureattributes.html"><a href="featureattributes.html#agr"><i class="fa fa-check"></i><b>6.1</b> Attribute-geometry relationship</a></li>
<li class="chapter" data-level="6.2" data-path="featureattributes.html"><a href="featureattributes.html#spatial-join"><i class="fa fa-check"></i><b>6.2</b> Spatial join</a></li>
<li class="chapter" data-level="6.3" data-path="featureattributes.html"><a href="featureattributes.html#aggregate-and-summarise"><i class="fa fa-check"></i><b>6.3</b> Aggregate and summarise</a></li>
<li class="chapter" data-level="6.4" data-path="featureattributes.html"><a href="featureattributes.html#intersections"><i class="fa fa-check"></i><b>6.4</b> Intersections</a></li>
<li class="chapter" data-level="6.5" data-path="featureattributes.html"><a href="featureattributes.html#area-weighted-interpolation"><i class="fa fa-check"></i><b>6.5</b> Area-weighted interpolation</a></li>
<li class="chapter" data-level="6.6" data-path="featureattributes.html"><a href="featureattributes.html#exercises-2"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rs.html"><a href="rs.html"><i class="fa fa-check"></i><b>7</b> Reference Systems</a><ul>
<li class="chapter" data-level="7.1" data-path="rs.html"><a href="rs.html#units"><i class="fa fa-check"></i><b>7.1</b> Units of measurement</a></li>
<li class="chapter" data-level="7.2" data-path="rs.html"><a href="rs.html#crs"><i class="fa fa-check"></i><b>7.2</b> Coordinate Reference Systems</a></li>
<li class="chapter" data-level="7.3" data-path="rs.html"><a href="rs.html#transform"><i class="fa fa-check"></i><b>7.3</b> Coordinate transformation and conversion</a></li>
</ul></li>
<li class="part"><span><b>II Maps</b></span></li>
<li class="chapter" data-level="8" data-path="plotting-spatial-data.html"><a href="plotting-spatial-data.html"><i class="fa fa-check"></i><b>8</b> Plotting spatial data</a></li>
<li class="chapter" data-level="9" data-path="plot.html"><a href="plot.html"><i class="fa fa-check"></i><b>9</b> Base Plot</a></li>
<li class="chapter" data-level="10" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>10</b> ggplot2</a></li>
<li class="chapter" data-level="11" data-path="interactive-maps.html"><a href="interactive-maps.html"><i class="fa fa-check"></i><b>11</b> Interactive Maps</a></li>
<li class="part"><span><b>III Spatial Analysis</b></span></li>
<li class="chapter" data-level="12" data-path="summarizing-geometries.html"><a href="summarizing-geometries.html"><i class="fa fa-check"></i><b>12</b> Summarizing Geometries</a></li>
<li class="chapter" data-level="13" data-path="point-pattern-analysis.html"><a href="point-pattern-analysis.html"><i class="fa fa-check"></i><b>13</b> Point Pattern Analysis</a></li>
<li class="chapter" data-level="14" data-path="manipulating-attributes-summarise-aggregate-union-sample.html"><a href="manipulating-attributes-summarise-aggregate-union-sample.html"><i class="fa fa-check"></i><b>14</b> Manipulating attributes: summarise, aggregate, union, sample</a></li>
<li class="chapter" data-level="15" data-path="units-of-measure-revisited-attribute-units-intensive-and-extensive-variables.html"><a href="units-of-measure-revisited-attribute-units-intensive-and-extensive-variables.html"><i class="fa fa-check"></i><b>15</b> Units of measure revisited: attribute units, intensive and extensive variables</a></li>
<li class="chapter" data-level="16" data-path="up-and-downscaling.html"><a href="up-and-downscaling.html"><i class="fa fa-check"></i><b>16</b> Up- and Downscaling</a></li>
<li class="chapter" data-level="17" data-path="spatial-interpolation-and-geostatistics.html"><a href="spatial-interpolation-and-geostatistics.html"><i class="fa fa-check"></i><b>17</b> Spatial Interpolation and geostatistics</a></li>
<li class="chapter" data-level="18" data-path="area-data-and-spatial-correlation.html"><a href="area-data-and-spatial-correlation.html"><i class="fa fa-check"></i><b>18</b> Area Data and Spatial Correlation</a></li>
<li class="chapter" data-level="19" data-path="spatial-regression-and-autocorrelation.html"><a href="spatial-regression-and-autocorrelation.html"><i class="fa fa-check"></i><b>19</b> Spatial Regression and Autocorrelation</a></li>
<li class="chapter" data-level="20" data-path="raster-modelling.html"><a href="raster-modelling.html"><i class="fa fa-check"></i><b>20</b> Raster Modelling</a></li>
<li class="part"><span><b>IV Spatiotemporal Analysis</b></span></li>
<li class="chapter" data-level="21" data-path="array.html"><a href="array.html"><i class="fa fa-check"></i><b>21</b> Array data: raster and vector data cubes</a></li>
<li class="chapter" data-level="22" data-path="movement-data.html"><a href="movement-data.html"><i class="fa fa-check"></i><b>22</b> Movement data</a></li>
<li class="chapter" data-level="23" data-path="statistical-modelling-of-spatiotemporal-data.html"><a href="statistical-modelling-of-spatiotemporal-data.html"><i class="fa fa-check"></i><b>23</b> Statistical modelling of spatiotemporal data</a></li>
<li class="chapter" data-level="24" data-path="scalability.html"><a href="scalability.html"><i class="fa fa-check"></i><b>24</b> Scalability</a><ul>
<li class="chapter" data-level="24.1" data-path="scalability.html"><a href="scalability.html#out-of-memory"><i class="fa fa-check"></i><b>24.1</b> Out-of-memory</a></li>
<li class="chapter" data-level="24.2" data-path="scalability.html"><a href="scalability.html#out-of-core"><i class="fa fa-check"></i><b>24.2</b> Out-of-core</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-data-structures.html"><a href="r-data-structures.html"><i class="fa fa-check"></i>R data structures</a><ul>
<li class="chapter" data-level="24.3" data-path="r-data-structures.html"><a href="r-data-structures.html#homogeneous-vectors"><i class="fa fa-check"></i><b>24.3</b> Homogeneous vectors</a></li>
<li class="chapter" data-level="24.4" data-path="r-data-structures.html"><a href="r-data-structures.html#heterogeneous-vectors-list"><i class="fa fa-check"></i><b>24.4</b> Heterogeneous vectors: list</a></li>
<li class="chapter" data-level="24.5" data-path="r-data-structures.html"><a href="r-data-structures.html#attributes"><i class="fa fa-check"></i><b>24.5</b> Attributes</a></li>
<li class="chapter" data-level="24.6" data-path="r-data-structures.html"><a href="r-data-structures.html#various-names-attributes"><i class="fa fa-check"></i><b>24.6</b> various names attributes</a></li>
<li class="chapter" data-level="24.7" data-path="r-data-structures.html"><a href="r-data-structures.html#using-structure"><i class="fa fa-check"></i><b>24.7</b> using structure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial Data Science with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="geommanip" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Geometric Manipulations</h1>
<p>Simple feature geometries can be queried for properties, combined into new geometries, and combinations of geometries can be queried for properties. This chapter will give an overview of the operations offered by <code>sf</code>.</p>
<p>We can categorise operations in terms of what they take as input, and what they give as output. In terms of input we have operations that take</p>
<ul>
<li>a single geometry (unary operations)</li>
<li>a pair of geometries (binary operations)</li>
<li>a set of geometries (n-ary operations)</li>
</ul>
<p>and in terms of what is returned, we distinguish</p>
<ul>
<li>predicates, returning a logical asserting a certain property is <code>TRUE</code></li>
<li>measures, returning a numeric value (possibly with measurement unit)</li>
<li>operations that return a new geometry, or a set of geometries</li>
</ul>
<p>We will now go through all combinations.</p>
<div id="unary-operations" class="section level2">
<h2><span class="header-section-number">5.1</span> Unary Operations</h2>
<div id="unary-predicates" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Unary predicates</h3>
<p><code>st_is_simple</code> <code>st_is_valid</code> <code>st_is_longlat</code></p>
<p><code>st_is</code></p>
<p><code>==</code> <code>!=</code> : <code>st_equals</code></p>
</div>
<div id="unary-measures" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Unary measures</h3>
<p><code>st_dimension</code> <code>st_area</code> <code>st_length</code> <code>st_geohash</code> <code>st_geometry_type</code></p>
</div>
<div id="unary-operations-returning-a-geometry" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Unary operations returning a geometry</h3>
<p><code>st_centroid</code> <code>st_buffer</code> <code>st_jitter</code> <code>st_wrap_dateline</code></p>
<p><code>st_boundary</code> <code>st_convex_hull</code> <code>st_line_merge</code> merges, on a per-feature basis, connecting <code>LINESTRING</code> elements of a <code>MULTILINESTRING</code> into longer <code>LINESTRING</code>s. <code>st_make_valid</code> <code>st_node</code> <code>st_point_on_surface</code> <code>st_polygonize</code> <code>st_segmentize</code> <code>st_simplify</code> <code>lwgeom::st_split</code> <code>st_transform</code> <code>st_triangulate</code> <code>st_voronoi</code></p>
<p><code>st_zm</code></p>
<p><code>st_collection_extract</code> <code>st_cast</code></p>
<p>Ops: + - (unary, binary)</p>
<p>Ops: * / (sfg, Matrix)</p>
</div>
</div>
<div id="binary-operations" class="section level2">
<h2><span class="header-section-number">5.2</span> Binary Operations</h2>
<div id="binary-predicates" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Binary predicates</h3>
<p><code>st_contains</code> <code>st_contains_properly</code> <code>st_covered_by</code> <code>st_covers</code> <code>st_crosses</code> <code>st_disjoint</code> <code>st_equals</code> <code>st_equals_exact</code> <code>st_intersects</code> <code>st_is_within_distance</code> <code>st_within</code> <code>st_touches</code> <code>st_overlaps</code></p>
</div>
<div id="binary-measures" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Binary measures</h3>
<p><code>st_distance</code> <code>st_relate</code></p>
</div>
<div id="binary-operations-returning-a-geometry" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Binary operations returning a geometry</h3>
<p><code>st_intersection</code> <code>&amp;</code> <code>st_union</code> <code>|</code> <code>st_difference</code> ‘/’ <code>st_sym_differenc</code> ‘%/%’</p>
</div>
</div>
<div id="n-ary-operations" class="section level2">
<h2><span class="header-section-number">5.3</span> N-ary Operations</h2>
<div id="n-ary-operations-returning-a-geometry" class="section level3">
<h3><span class="header-section-number">5.3.1</span> N-ary operations returning a geometry</h3>
<p>For n-ary operations, we have only two, n-ary <code>st_intersection</code> and <code>st_difference</code>, which both return geometries, in case of <code>st_intersection</code> along with some properties for each of the geometry.</p>
<p><code>st_make_grid</code> <code>st_graticule</code></p>
</div>
</div>
<div id="precision" class="section level2">
<h2><span class="header-section-number">5.4</span> Precision</h2>
<p>Geometrical operations, such as finding out whether a certain point is on a line, may fail when coordinates are represented by highly precise floating point numbers, such as 8-byte doubles in R. A remedy might be to limit the precision of the coordinates before the operation. For this, a <em>precision model</em> is adopted by <code>sf</code>. It uses a precision value to round coordinates (X, Y, Z and M) right before they are encoded as well-known binary, and passed on to the libraries where this may have an effect (GEOS, GDAL, liblwgeom). We demonstrate this by an R - WKB - R roundtrip.</p>
<p>Rounding can be done by three different options. With a negative precision value, 8-byte doubles get converted to 4-byte floats and back again:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">old =<span class="st"> </span><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">16</span>)
(<span class="dt">p =</span> <span class="kw">st_sfc</span>(<span class="kw">st_point</span>(<span class="kw">c</span>(<span class="fl">1e6</span><span class="op">/</span><span class="dv">3</span>, <span class="fl">1e4</span><span class="op">/</span><span class="dv">3</span>))))
<span class="co">#&gt; Geometry set for 1 feature </span>
<span class="co">#&gt; geometry type:  POINT</span>
<span class="co">#&gt; dimension:      XY</span>
<span class="co">#&gt; bbox:           xmin: 333333.333333333 ymin: 3333.33333333333 xmax: 333333.333333333 ymax: 3333.33333333333</span>
<span class="co">#&gt; epsg (SRID):    NA</span>
<span class="co">#&gt; proj4string:    NA</span>
<span class="co">#&gt; POINT (333333.3333333333 3333.333333333333)</span>
p <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_set_precision</span>(<span class="op">-</span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_as_binary</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_as_sfc</span>() <span class="op">%&gt;%</span><span class="st"> `</span><span class="dt">[[</span><span class="st">`</span>(<span class="dv">1</span>)
<span class="co">#&gt; POINT (333333.34375 3333.333251953125)</span></code></pre></div>
<p>With a positive precision <span class="math inline">\(p\)</span>, each coordinate value <span class="math inline">\(c\)</span> is replaced by <span class="math display">\[c&#39; = \mbox{round}(p \cdot c) / p\]</span> This implies that for instance with a precision of 1000, the number of decimal placed to round to is 1/1000:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_set_precision</span>(<span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_as_binary</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_as_sfc</span>() <span class="op">%&gt;%</span><span class="st"> `</span><span class="dt">[[</span><span class="st">`</span>(<span class="dv">1</span>)
<span class="co">#&gt; POINT (333333.333 3333.333)</span></code></pre></div>
<p>With a precision of e.g. 0.001 or 0.05, rounding to the nearest <code>1/precision</code>, i.e. 1000 or 20, is obtained:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_set_precision</span>(<span class="fl">0.001</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_as_binary</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_as_sfc</span>() <span class="op">%&gt;%</span><span class="st"> `</span><span class="dt">[[</span><span class="st">`</span>(<span class="dv">1</span>) <span class="co"># nearest 1000</span>
<span class="co">#&gt; POINT (333000 3000)</span>
p <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_set_precision</span>(<span class="fl">0.05</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_as_binary</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">st_as_sfc</span>()  <span class="op">%&gt;%</span><span class="st"> `</span><span class="dt">[[</span><span class="st">`</span>(<span class="dv">1</span>) <span class="co"># nearest 20</span>
<span class="co">#&gt; POINT (333340 3340)</span>
<span class="kw">options</span>(<span class="dt">digits =</span> old<span class="op">$</span>digits)</code></pre></div>
<p>In essence, these rounding methods bring the coordinates to points on a regular grid, which is beneficial for geometric computations. Of course, it also affects all computations like areas and distances. Which precision values are best for which application is often a matter of trial and error. A reproducible example illustrating the need for setting precision is found <a href="https://github.com/r-spatial/sf/issues/275">here</a>.</p>
</div>
<div id="longlat" class="section level2">
<h2><span class="header-section-number">5.5</span> Warnings for longitude/latitude geometries</h2>
<p>In st_centroid.sfc(st_geometry(x), of_largest_polygon = of_largest_polygon) : st_centroid does not give correct centroids for longitude/latitude data</p>
<p>How serious is this?</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="raster.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="featureattributes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/edzer/sdsr/edit/master/05-GeomManipulations.Rmd",
"text": "Edit"
},
"download": ["sdsr.pdf", "sdsr.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
