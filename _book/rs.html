<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Reference Systems | Spatial Data Science</title>
  <meta name="description" content="description_xx" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Reference Systems | Spatial Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="description_xx" />
  <meta name="github-repo" content="edzer/sdsr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Reference Systems | Spatial Data Science" />
  
  <meta name="twitter:description" content="description_xx" />
  

<meta name="author" content="Edzer Pebesma, Roger Bivand" />


<meta name="date" content="2021-02-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="updownscaling.html"/>
<link rel="next" href="plotting.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/fgb.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/flatgeobuf-geojson.min.js"></script>
<script src="libs/chromajs-2.1.0/chroma.min.js"></script>
<link id="_-BIR74-1-attachment" rel="attachment" href="libs/_-BIR74-0.0.1/_-BIR74_layer.fgb"/>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = false;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Spatial Data</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Getting Started</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#a-first-map"><i class="fa fa-check"></i><b>1.1</b> A first map</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#coordinate-reference-systems"><i class="fa fa-check"></i><b>1.2</b> Coordinate reference systems</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#raster-and-vector-data"><i class="fa fa-check"></i><b>1.3</b> Raster and vector data</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#raster-types"><i class="fa fa-check"></i><b>1.4</b> Raster types</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#time-series-arrays-data-cubes"><i class="fa fa-check"></i><b>1.5</b> Time series, arrays, data cubes</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#support"><i class="fa fa-check"></i><b>1.6</b> Support</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#spatial-data-science-software"><i class="fa fa-check"></i><b>1.7</b> Spatial data science software</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cs.html"><a href="cs.html"><i class="fa fa-check"></i><b>2</b> Coordinates</a><ul>
<li class="chapter" data-level="2.1" data-path="cs.html"><a href="cs.html#units"><i class="fa fa-check"></i><b>2.1</b> Quantities and units</a></li>
<li class="chapter" data-level="2.2" data-path="cs.html"><a href="cs.html#spatial-coordinates-geodetic-and-cartesian"><i class="fa fa-check"></i><b>2.2</b> Spatial coordinates: Geodetic and Cartesian</a></li>
<li class="chapter" data-level="2.3" data-path="cs.html"><a href="cs.html#crs"><i class="fa fa-check"></i><b>2.3</b> Coordinate Reference Systems</a></li>
<li class="chapter" data-level="2.4" data-path="cs.html"><a href="cs.html#proj-and-mapping-accuracy"><i class="fa fa-check"></i><b>2.4</b> PROJ and mapping accuracy</a></li>
<li class="chapter" data-level="2.5" data-path="cs.html"><a href="cs.html#exercises-1"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geometries.html"><a href="geometries.html"><i class="fa fa-check"></i><b>3</b> Geometries</a><ul>
<li class="chapter" data-level="3.1" data-path="geometries.html"><a href="geometries.html#simple-feature-geometries"><i class="fa fa-check"></i><b>3.1</b> Simple feature geometries</a></li>
<li class="chapter" data-level="3.2" data-path="geometries.html"><a href="geometries.html#opgeom"><i class="fa fa-check"></i><b>3.2</b> Operations on geometries</a></li>
<li class="chapter" data-level="3.3" data-path="geometries.html"><a href="geometries.html#precision"><i class="fa fa-check"></i><b>3.3</b> Precision</a></li>
<li class="chapter" data-level="3.4" data-path="geometries.html"><a href="geometries.html#coverages"><i class="fa fa-check"></i><b>3.4</b> Coverages: tesselations and rasters</a></li>
<li class="chapter" data-level="3.5" data-path="geometries.html"><a href="geometries.html#networks"><i class="fa fa-check"></i><b>3.5</b> Networks</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spherical.html"><a href="spherical.html"><i class="fa fa-check"></i><b>4</b> Spherical Geometries</a><ul>
<li class="chapter" data-level="4.1" data-path="spherical.html"><a href="spherical.html#straight-lines"><i class="fa fa-check"></i><b>4.1</b> Straight lines</a></li>
<li class="chapter" data-level="4.2" data-path="spherical.html"><a href="spherical.html#ring-direction"><i class="fa fa-check"></i><b>4.2</b> Ring direction</a></li>
<li class="chapter" data-level="4.3" data-path="spherical.html"><a href="spherical.html#full-polygon"><i class="fa fa-check"></i><b>4.3</b> Full polygon</a></li>
<li class="chapter" data-level="4.4" data-path="spherical.html"><a href="spherical.html#bounding-box-rectangle-and-cap"><i class="fa fa-check"></i><b>4.4</b> Bounding box, rectangle, and cap</a></li>
<li class="chapter" data-level="4.5" data-path="spherical.html"><a href="spherical.html#validity-on-the-sphere"><i class="fa fa-check"></i><b>4.5</b> Validity on the sphere</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="featureattributes.html"><a href="featureattributes.html"><i class="fa fa-check"></i><b>5</b> Attributes, Up- and Downscaling</a><ul>
<li class="chapter" data-level="5.1" data-path="featureattributes.html"><a href="featureattributes.html#agr"><i class="fa fa-check"></i><b>5.1</b> Attribute-geometry relationships</a></li>
<li class="chapter" data-level="5.2" data-path="featureattributes.html"><a href="featureattributes.html#spatial-join"><i class="fa fa-check"></i><b>5.2</b> Spatial join</a></li>
<li class="chapter" data-level="5.3" data-path="featureattributes.html"><a href="featureattributes.html#aggregating-and-summarising"><i class="fa fa-check"></i><b>5.3</b> Aggregating and Summarising</a></li>
<li class="chapter" data-level="5.4" data-path="featureattributes.html"><a href="featureattributes.html#area-weighted"><i class="fa fa-check"></i><b>5.4</b> Area-weighted interpolation</a></li>
<li class="chapter" data-level="5.5" data-path="featureattributes.html"><a href="featureattributes.html#exercises-2"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="raster.html"><a href="raster.html"><i class="fa fa-check"></i><b>6</b> Raster and vector datacubes</a><ul>
<li class="chapter" data-level="6.1" data-path="raster.html"><a href="raster.html#package-stars"><i class="fa fa-check"></i><b>6.1</b> Package <code>stars</code></a></li>
<li class="chapter" data-level="6.2" data-path="raster.html"><a href="raster.html#raster-data"><i class="fa fa-check"></i><b>6.2</b> Raster data</a></li>
<li class="chapter" data-level="6.3" data-path="raster.html"><a href="raster.html#datacubes"><i class="fa fa-check"></i><b>6.3</b> Vector Datacubes</a></li>
<li class="chapter" data-level="6.4" data-path="raster.html"><a href="raster.html#exercises-3"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="updownscaling.html"><a href="updownscaling.html"><i class="fa fa-check"></i><b>7</b> Up- and Downscaling</a></li>
<li class="chapter" data-level="8" data-path="rs.html"><a href="rs.html"><i class="fa fa-check"></i><b>8</b> Reference Systems</a><ul>
<li class="chapter" data-level="8.1" data-path="cs.html"><a href="cs.html#units"><i class="fa fa-check"></i><b>8.1</b> Units of measurement</a></li>
<li class="chapter" data-level="8.2" data-path="rs.html"><a href="rs.html#temporal-reference-systems"><i class="fa fa-check"></i><b>8.2</b> Temporal Reference Systems</a></li>
<li class="chapter" data-level="8.3" data-path="cs.html"><a href="cs.html#crs"><i class="fa fa-check"></i><b>8.3</b> Coordinate Reference Systems</a></li>
</ul></li>
<li class="part"><span><b>II R for Spatial Data Science</b></span></li>
<li class="chapter" data-level="9" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>9</b> Plotting spatial data</a><ul>
<li class="chapter" data-level="9.1" data-path="plotting.html"><a href="plotting.html#transform"><i class="fa fa-check"></i><b>9.1</b> Every plot is a projection</a></li>
<li class="chapter" data-level="9.2" data-path="plotting.html"><a href="plotting.html#plotting-points-lines-polygons-grid-cells"><i class="fa fa-check"></i><b>9.2</b> Plotting points, lines, polygons, grid cells</a></li>
<li class="chapter" data-level="9.3" data-path="plotting.html"><a href="plotting.html#classintervals"><i class="fa fa-check"></i><b>9.3</b> Color palettes and class intervals</a></li>
<li class="chapter" data-level="9.4" data-path="plotting.html"><a href="plotting.html#poles-and-datelines"><i class="fa fa-check"></i><b>9.4</b> Poles and datelines</a></li>
<li class="chapter" data-level="9.5" data-path="plotting.html"><a href="plotting.html#graticule"><i class="fa fa-check"></i><b>9.5</b> Graticules and other navigation aids</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="plot.html"><a href="plot.html"><i class="fa fa-check"></i><b>10</b> Base and grid plots</a><ul>
<li class="chapter" data-level="10.1" data-path="plot.html"><a href="plot.html#base-plots"><i class="fa fa-check"></i><b>10.1</b> Base plots</a></li>
<li class="chapter" data-level="10.2" data-path="plot.html"><a href="plot.html#combining-base-plots"><i class="fa fa-check"></i><b>10.2</b> Combining base plots</a></li>
<li class="chapter" data-level="10.3" data-path="plot.html"><a href="plot.html#grid-plots-and-viewports"><i class="fa fa-check"></i><b>10.3</b> Grid plots and viewports</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>11</b> ggplot2</a><ul>
<li class="chapter" data-level="11.1" data-path="ggplot2.html"><a href="ggplot2.html#geom_sf"><i class="fa fa-check"></i><b>11.1</b> <code>geom_sf</code></a></li>
<li class="chapter" data-level="11.2" data-path="ggplot2.html"><a href="ggplot2.html#geom_stars"><i class="fa fa-check"></i><b>11.2</b> <code>geom_stars</code></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="interactive.html"><a href="interactive.html"><i class="fa fa-check"></i><b>12</b> Interactive Maps</a></li>
<li class="part"><span><b>III Models for Spatial Data</b></span></li>
<li class="chapter" data-level="13" data-path="pointpatterns.html"><a href="pointpatterns.html"><i class="fa fa-check"></i><b>13</b> Point Pattern Analysis</a></li>
<li class="chapter" data-level="14" data-path="manipulating-attributes-summarise-aggregate-union-sample.html"><a href="manipulating-attributes-summarise-aggregate-union-sample.html"><i class="fa fa-check"></i><b>14</b> Manipulating attributes: summarise, aggregate, union, sample</a></li>
<li class="chapter" data-level="15" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html"><i class="fa fa-check"></i><b>15</b> Area Data and Spatial Autocorrelation</a><ul>
<li class="chapter" data-level="15.1" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>15.1</b> Spatial autocorrelation</a></li>
<li class="chapter" data-level="15.2" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#spatial-weight-matrices"><i class="fa fa-check"></i><b>15.2</b> Spatial weight matrices</a></li>
<li class="chapter" data-level="15.3" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#measures-of-spatial-autocorrelation"><i class="fa fa-check"></i><b>15.3</b> Measures of spatial autocorrelation</a></li>
<li class="chapter" data-level="15.4" data-path="area-data-and-spatial-autocorrelation.html"><a href="area-data-and-spatial-autocorrelation.html#spatial-heterogeneity"><i class="fa fa-check"></i><b>15.4</b> Spatial heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="spatial-regression.html"><a href="spatial-regression.html"><i class="fa fa-check"></i><b>16</b> Spatial Regression</a><ul>
<li class="chapter" data-level="16.1" data-path="spatial-regression.html"><a href="spatial-regression.html#spatial-regression-with-spatial-weights"><i class="fa fa-check"></i><b>16.1</b> Spatial regression with spatial weights</a></li>
<li class="chapter" data-level="16.2" data-path="spatial-regression.html"><a href="spatial-regression.html#estimators"><i class="fa fa-check"></i><b>16.2</b> Estimators</a></li>
<li class="chapter" data-level="16.3" data-path="spatial-regression.html"><a href="spatial-regression.html#implementation-details"><i class="fa fa-check"></i><b>16.3</b> Implementation details</a></li>
<li class="chapter" data-level="16.4" data-path="spatial-regression.html"><a href="spatial-regression.html#markov-random-field-and-multilevel-models-with-spatial-weights"><i class="fa fa-check"></i><b>16.4</b> Markov random field and multilevel models with spatial weights</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="movement-data.html"><a href="movement-data.html"><i class="fa fa-check"></i><b>17</b> Movement data</a></li>
<li class="chapter" data-level="18" data-path="statistical-modelling-of-spatiotemporal-data.html"><a href="statistical-modelling-of-spatiotemporal-data.html"><i class="fa fa-check"></i><b>18</b> Statistical modelling of spatiotemporal data</a></li>
<li class="chapter" data-level="19" data-path="sp-and-raster.html"><a href="sp-and-raster.html"><i class="fa fa-check"></i><b>19</b> sp and raster</a><ul>
<li class="chapter" data-level="19.1" data-path="sp-and-raster.html"><a href="sp-and-raster.html#links-and-differences-between-sf-and-sp"><i class="fa fa-check"></i><b>19.1</b> links and differences between sf and sp</a></li>
<li class="chapter" data-level="19.2" data-path="sp-and-raster.html"><a href="sp-and-raster.html#migration-packages"><i class="fa fa-check"></i><b>19.2</b> migration packages</a></li>
<li class="chapter" data-level="19.3" data-path="sp-and-raster.html"><a href="sp-and-raster.html#raster-stars-and-sf"><i class="fa fa-check"></i><b>19.3</b> raster, stars and sf</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i>R basics</a><ul>
<li class="chapter" data-level="19.4" data-path="r-basics.html"><a href="r-basics.html#pipes"><i class="fa fa-check"></i><b>19.4</b> Pipes</a></li>
<li class="chapter" data-level="19.5" data-path="r-basics.html"><a href="r-basics.html#data-structures"><i class="fa fa-check"></i><b>19.5</b> Data structures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rs" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Reference Systems</h1>
<p>“<em>Data are not just numbers, they are numbers with a context</em>”;
“<em>In data analysis, context provides meaning</em>” <span class="citation">(Cobb and Moore <a href="#ref-cobbmoore">1997</a>)</span></p>
<div id="units" class="section level2">
<h2><span class="header-section-number">8.1</span> Units of measurement</h2>
<div id="quantities" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Quantities</h3>
<p>The VIM (International vocabulary of metrology, <span class="citation">BIPM et al. (<a href="#ref-vim">2012</a>)</span>)
defines a <em>quantity</em> as a “property of a phenomenon, body, or
substance, where the property has a magnitude that can be expressed
as a number and a reference”, where “[a] reference can be a measurement
unit, a measurement procedure, a reference material, or a combination
of such.”</p>
<p>One could argue whether all data is constituted of quantities, but
there is no need to argue that proper data handling requires that
numbers are accompanied by information on what the numbers mean,
and what they are about.</p>
<p>A measurement system consist of <em>base units</em> for base quantities, and
<em>derived units</em> for derived quantities. The SI system of units <span class="citation">(Bureau International des Poids et Mesures <a href="#ref-SI">2006</a>)</span>
consist of the seven base units length (metre, m), mass (kilogram,
kg), time (second, s), electric current (ampere, A), thermodynamic
temperature (kelvin, K), amount of substance (mole, mol), and
luminous intensity (candela, cd). Derived units are composed
of products of integer powers of base units; exampes are speed
(<span class="math inline">\(\mbox{m}~\mbox{s}^{-1}\)</span>) and density (<span class="math inline">\(\mbox{kg}~\mbox{m}^{-3}\)</span>).</p>
<p>Many data variables have units that are not expressed as SI base
units or derived units. <span class="citation">Hand (<a href="#ref-hand">2004</a>)</span> discusses many such measurement scales,
e.g. those used to measure intelligence in social sciences, in the
context of measurement units.</p>
</div>
<div id="unitless-measures-1" class="section level3">
<h3><span class="header-section-number">8.1.2</span> Unitless measures</h3>
<p>The special case of unitless units can refer to either cases where
units cancelled out (e.g. mass fraction: kg/kg, or angle measured
in rad: m/m) or to cases where objects or events were counted
(e.g. 5 apples). Adding an angle to a count of apples would not make
sense; adding 5 apples to 3 oranges may make sense if the result is
reinterpreted, e.g. as <em>pieces of fruit</em>. <span class="citation">Flater (<a href="#ref-flater">2018</a>)</span> discusses systems
for proper handling of unitless quantities; handling counts could for
instance link to domain-specific ontologies pointing out which things
were counted, and perhaps identifying super-classes, like <em>fruit</em>.</p>
</div>
<div id="units-in-r" class="section level3">
<h3><span class="header-section-number">8.1.3</span> Units in R</h3>
<p>The <code>units</code> R package <span class="citation">(Pebesma, Mailund, and Hiebert <a href="#ref-unitsrj">2016</a>)</span> provides units
of measurement support for R, by interfacing the
<a href="https://www.unidata.ucar.edu/software/udunits/">udunits2</a> units
database and C library. It allows for setting, converting and deriving
units:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" title="1"><span class="kw">library</span>(units)</a>
<a class="sourceLine" id="cb195-2" title="2">(<span class="dt">a =</span> <span class="kw">set_units</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, m))</a></code></pre></div>
<pre><code># Units: [m]
# [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" title="1">a_km =<span class="st"> </span><span class="kw">set_units</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, km)</a>
<a class="sourceLine" id="cb197-2" title="2">a <span class="op">+</span><span class="st"> </span>a_km</a></code></pre></div>
<pre><code># Units: [m]
# [1] 1001 2002 3003</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" title="1">b =<span class="st"> </span><span class="kw">set_units</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>, s)</a>
<a class="sourceLine" id="cb199-2" title="2">a <span class="op">/</span><span class="st"> </span>b</a></code></pre></div>
<pre><code># Units: [m/s]
# [1] 0.25 0.40 0.50</code></pre>
<p>and raises errors in case of meaningless operations</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" title="1">a <span class="op">+</span><span class="st"> </span>b</a></code></pre></div>
<pre><code># Error: cannot convert s into m</code></pre>
</div>
<div id="datum" class="section level3">
<h3><span class="header-section-number">8.1.4</span> Datum</h3>
<p>For many quantities, the natural origin of values is zero. This
works for amounts, and differences between amounts results in
meaningful negative values. For locations and times, differences
have a natural zero interpretation: length and duration. Absolute
location (position) and time need a fixed origin, from which we can
meaningfully measure other absolute space-time points: a datum. For space,
a datum involves more than one dimension. The combination of a datum
and a measurement unit (scale) is a a <em>reference system</em>. The next
two sections will deal with temporal and spatial reference systems,
and how they are handled in R.</p>
</div>
</div>
<div id="temporal-reference-systems" class="section level2">
<h2><span class="header-section-number">8.2</span> Temporal Reference Systems</h2>
<p>R has two native classes for time-related data: <code>POSIXt</code> and <code>Date</code>,
which are used for specifying dates, and times.</p>
<div id="date" class="section level3">
<h3><span class="header-section-number">8.2.1</span> <code>Date</code></h3>
<p><code>Date</code> objects are numeric vectors of class <code>Date</code>, which contain
the number of days since (or in case negative: before) Jan 1, 1970:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" title="1">(<span class="dt">d =</span> <span class="kw">as.Date</span>(<span class="st">&quot;1970-02-01&quot;</span>))</a></code></pre></div>
<pre><code># [1] &quot;1970-02-01&quot;</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" title="1"><span class="kw">as.numeric</span>(d)</a></code></pre></div>
<pre><code># [1] 31</code></pre>
<p>We see that the <code>print</code> method as well as the <code>as.Date</code> method use
ISO 8601 <span class="citation">(ISO8601 <a href="#ref-iso8601">2000</a>)</span> character strings, which is standard used to
read and write dates. We can also modify this to local conventions
by specifying a <code>format</code>:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1">(<span class="dt">d =</span> <span class="kw">as.Date</span>(<span class="st">&quot;01.02.1970&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%d.%m.%Y&quot;</span>))</a></code></pre></div>
<pre><code># [1] &quot;1970-02-01&quot;</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1"><span class="kw">format</span>(d, <span class="dt">format =</span> <span class="st">&quot;%d.%m.%Y&quot;</span>)</a></code></pre></div>
<pre><code># [1] &quot;01.02.1970&quot;</code></pre>
<p>The default for <code>format</code> may depend on the locale settings of
the computer used. The help page of <code>?as.Date</code> contains further
discussion of date systems, and calendars used.</p>
</div>
<div id="posixt" class="section level3">
<h3><span class="header-section-number">8.2.2</span> POSIXt</h3>
<p><code>POSIXt</code> is an R native class for specifying times. It has two
subclasses: <code>POSIXct</code> represents time as a numeric, representing decimal
seconds since 1970-01-01 00:00 UTC, and <code>POSIXlt</code> contains the same
information as a list with all time components (second, minute,
hour, day of month, month, year) in list components:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" title="1">t =<span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="st">&quot;1970-01-01 01:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;UTC&quot;</span>)</a>
<a class="sourceLine" id="cb211-2" title="2"><span class="kw">as.numeric</span>(t)</a></code></pre></div>
<pre><code># [1] 3600</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" title="1"><span class="kw">names</span>(<span class="kw">unclass</span>(<span class="kw">as.POSIXlt</span>(t)))</a></code></pre></div>
<pre><code># [1] &quot;sec&quot;   &quot;min&quot;   &quot;hour&quot;  &quot;mday&quot;  &quot;mon&quot;   &quot;year&quot;  &quot;wday&quot;  &quot;yday&quot;  &quot;isdst&quot;</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" title="1"><span class="kw">unclass</span>(<span class="kw">as.POSIXlt</span>(t))<span class="op">$</span>hour</a></code></pre></div>
<pre><code># [1] 1</code></pre>
</div>
<div id="time-zones" class="section level3">
<h3><span class="header-section-number">8.2.3</span> Time zones</h3>
<p>Time zones can be seen as local modifiers of time: where time as
numeric value is stored with respect to UTC (universal coordinated
time), a local time zone is used to format it, and a time zone can
be specified for creation, and formatting:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" title="1">(<span class="dt">t =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;1970-01-01 00:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;PST&quot;</span>))</a></code></pre></div>
<pre><code># [1] &quot;1970-01-01 PST&quot;</code></pre>
<p>this adds a time zone modifier to <code>t</code> that redefines the time origin, as</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" title="1"><span class="kw">as.numeric</span>(t)</a></code></pre></div>
<pre><code># [1] 0</code></pre>
<p>To convert <code>POSIXt</code> to <code>Date</code> we can use <code>as.Date</code>; this converts
to the <em>local</em> date. Converting back to <code>POSIXct</code> looses the time
of day and time zone information.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" title="1">(<span class="dt">t =</span> <span class="kw">as.POSIXct</span>(<span class="st">&quot;1970-01-01 23:00:00&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;PST&quot;</span>))</a></code></pre></div>
<pre><code># [1] &quot;1970-01-01 23:00:00 PST&quot;</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" title="1"><span class="kw">as.Date</span>(t)</a></code></pre></div>
<pre><code># [1] &quot;1970-01-01&quot;</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" title="1"><span class="kw">format</span>(<span class="kw">as.POSIXct</span>(<span class="kw">as.Date</span>(t)), <span class="dt">tz =</span> <span class="st">&quot;UTC&quot;</span>)</a></code></pre></div>
<pre><code># [1] &quot;1970-01-01&quot;</code></pre>
<p>Working with local time zones is sometimes confusing when the data
we work with were not referenced to this time zone. It may help
to set</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" title="1"><span class="kw">Sys.setenv</span>(<span class="dt">TZ=</span><span class="st">&quot;UTC&quot;</span>)</a></code></pre></div>
<p>at the start of an R script. The effect is, at lease on some
platforms, that R thinks it is working in a UTC time zone. This way,
the scripts will produce identical outputs, no matter in which time
zone it is run.</p>
</div>
</div>
<div id="crs" class="section level2">
<h2><span class="header-section-number">8.3</span> Coordinate Reference Systems</h2>
<p>We follow <span class="citation">Lott (<a href="#ref-lott2015geographic">2015</a>)</span> when defining the following concepts (italics indicate literal quoting):</p>
<ul>
<li>a <strong>coordinate system</strong> is a <em>set of mathematical rules for specifying how coordinates are to be assigned to points</em></li>
<li>a <strong>datum</strong> is a <em>parameter or set of parameters that define the position of the origin, the scale, and the orientation of a coordinate system</em>,</li>
<li>a <strong>geodetic datum</strong> is a <em>datum describing the relationship of a two- or three-dimensional coordinate system to the Earth</em>, and</li>
<li>a <strong>coordinate reference system</strong> is a <em>coordinate system that is related to an object by a datum; for geodetic and vertical datums, the object will be the Earth.</em></li>
</ul>
<p>A readable text that further explains these concepts is <span class="citation">Iliffe and Lott (<a href="#ref-iliffelott">2008</a>)</span>.</p>
<p>Essentially it boils down to the Earth not following a regular shape. The topography of the Earth is of course known to vary strongly, but also the surface formed by constant gravity at mean sea level, the geoid, is irregular. A commonly used model that is fit to the geoid is an ellipsoid of revolution, which is an ellipse with two identical minor axes. This model can be fit locally to be highly precise, can be fixed for particular tectonic plates (like ETRS89), or can be globally fit (like WGS84).</p>
<p>The definitions above state that coordinates in degrees longitude
and latitude can only have a meaning, i.e. can only be understood
as Earth coordinates when the datum they relate to is given.</p>
<p>Recomputing coordinates in a new datum is called <em>coordinate
transformation</em>.</p>
<div id="projections" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Projections</h3>
<p>When we look at geographical data on a paper map or a screen, or
on any <em>flat</em> device, we see the values <em>projected</em> – they are no
longer arranged on an a sphere or ellipsoid. Even if we plot degrees
longitude/latitude data on a flat x/y plane with unit aspect ratio,
we use a projection, called <em>plate carrée</em>.</p>
<p>Note that even for projected data, the data that <em>were</em> projected
are associated with a reference ellipsoid (datum). Going from one
projection to the other without changing datum is called <em>coordinate
conversion</em>, and usually passes through the geographic coordinates of
the datum involved; up to numerical errors this process is lossless
and invertible.</p>
</div>
<div id="describing-coordinate-reference-systems" class="section level3">
<h3><span class="header-section-number">8.3.2</span> Describing Coordinate Reference Systems</h3>
<p><span class="citation">Lott (<a href="#ref-lott2015geographic">2015</a>)</span> describes a standard for encoding coordinate
reference system using <em>well known text</em>; the standard is referred
to as WKT2. GDAL and PROJ support this encoding (FIXME: verify this
is true by the time this book goes into print).</p>
<p>Traditionally, PROJ used a string representation to encode coordinate
reference systems (datums) and projections, called the proj4string.
Some of these come from a catalogue (originally) compiled by the
European Petroleum Survey Group (now: International Association of
Oil &amp; Gas Producers), and have a so-called epsg code.</p>
<p>Package <code>sf</code> provides a <code>crs</code> class which is initialised either by
an epsg code, like</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" title="1"><span class="kw">st_crs</span>(<span class="dv">4326</span>)</a></code></pre></div>
<pre><code># Coordinate Reference System:
#   User input: EPSG:4326 
#   wkt:
# GEOGCRS[&quot;WGS 84&quot;,
#     DATUM[&quot;World Geodetic System 1984&quot;,
#         ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
#             LENGTHUNIT[&quot;metre&quot;,1]]],
#     PRIMEM[&quot;Greenwich&quot;,0,
#         ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
#     CS[ellipsoidal,2],
#         AXIS[&quot;geodetic latitude (Lat)&quot;,north,
#             ORDER[1],
#             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
#         AXIS[&quot;geodetic longitude (Lon)&quot;,east,
#             ORDER[2],
#             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
#     USAGE[
#         SCOPE[&quot;Horizontal component of 3D system.&quot;],
#         AREA[&quot;World.&quot;],
#         BBOX[-90,-180,90,180]],
#     ID[&quot;EPSG&quot;,4326]]</code></pre>
<p>or by a PROJ string, like</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" title="1"><span class="kw">st_crs</span>(<span class="st">&quot;+proj=longlat&quot;</span>)</a></code></pre></div>
<pre><code># Coordinate Reference System:
#   User input: +proj=longlat 
#   wkt:
# GEOGCRS[&quot;unknown&quot;,
#     DATUM[&quot;World Geodetic System 1984&quot;,
#         ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
#             LENGTHUNIT[&quot;metre&quot;,1]],
#         ID[&quot;EPSG&quot;,6326]],
#     PRIMEM[&quot;Greenwich&quot;,0,
#         ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
#         ID[&quot;EPSG&quot;,8901]],
#     CS[ellipsoidal,2],
#         AXIS[&quot;longitude&quot;,east,
#             ORDER[1],
#             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433,
#                 ID[&quot;EPSG&quot;,9122]]],
#         AXIS[&quot;latitude&quot;,north,
#             ORDER[2],
#             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433,
#                 ID[&quot;EPSG&quot;,9122]]]]</code></pre>
<p>and can be missing valued</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" title="1"><span class="kw">st_crs</span>()</a></code></pre></div>
<pre><code># Coordinate Reference System: NA</code></pre>
<p>A number of methods are available for <code>crs</code> objects:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" title="1"><span class="kw">methods</span>(<span class="dt">class =</span> <span class="st">&quot;crs&quot;</span>)</a></code></pre></div>
<pre><code>#  [1] $           coerce      format      initialize  is.na       Ops        
#  [7] print       show        slotsFromS3 st_as_text  st_crs     
# see &#39;?methods&#39; for accessing help and source code</code></pre>
<p>The <code>Ops</code> methods are convenience functions, e.g.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" title="1"><span class="kw">st_crs</span>(<span class="dv">4326</span>) <span class="op">==</span><span class="st"> </span><span class="kw">st_crs</span>(<span class="st">&quot;+proj=longlat&quot;</span>)</a></code></pre></div>
<pre><code># [1] TRUE</code></pre>
<p>but there not all cases semantically identical <code>crs</code> objects will
yield equality in this test.</p>
<p><code>st_as_text</code> converts a <code>crs</code> object into WKT, we print it using <code>cat</code>:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" title="1"><span class="kw">cat</span>(<span class="kw">st_as_text</span>(<span class="kw">st_crs</span>(<span class="dv">4326</span>), <span class="dt">pretty =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code># GEOGCS[&quot;WGS 84&quot;,
#     DATUM[&quot;WGS_1984&quot;,
#         SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563]],
#     PRIMEM[&quot;Greenwich&quot;,0],
#     UNIT[&quot;degree&quot;,0.0174532925199433,
#         AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],
#     AXIS[&quot;Latitude&quot;,NORTH],
#     AXIS[&quot;Longitude&quot;,EAST],
#     AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</code></pre>
<p>It should be noted that at the time of writing this, a new draft
standard for WKT (informally called WKT2, <span class="citation">Lott (<a href="#ref-lott2015geographic">2015</a>)</span>) is
rapidly being implemented in GDAL and PROJ, and can be expected in
R once these changes appear in released versions.</p>
<p><code>st_crs</code> is also a generic, with methods for</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" title="1"><span class="kw">methods</span>(st_crs)</a></code></pre></div>
<pre><code>#  [1] st_crs.bbox*       st_crs.character*  st_crs.crs*        st_crs.CRS*       
#  [5] st_crs.default*    st_crs.dimensions* st_crs.numeric*    st_crs.Raster*    
#  [9] st_crs.sf*         st_crs.sfc*        st_crs.Spatial*    st_crs.SpatRaster*
# [13] st_crs.stars*     
# see &#39;?methods&#39; for accessing help and source code</code></pre>
<p>The method for <code>sfc</code> objects can drill further into the underlying
data, by adding an argument; a few of these are printed by</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" title="1"><span class="kw">st_crs</span>(<span class="kw">st_sfc</span>(<span class="dt">crs =</span> <span class="dv">4326</span>), <span class="dt">parameters =</span> <span class="ot">TRUE</span>)[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">8</span>)]</a></code></pre></div>
<pre><code># $SemiMajor
# 6378137 [m]
# 
# $SemiMinor
# 6356752 [m]
# 
# $InvFlattening
# [1] 298
# 
# $IsGeographic
# [1] TRUE
# 
# $Wkt
# [1] &quot;GEOGCS[\&quot;WGS 84\&quot;,DATUM[\&quot;WGS_1984\&quot;,SPHEROID[\&quot;WGS 84\&quot;,6378137,298.257223563]],PRIMEM[\&quot;Greenwich\&quot;,0],UNIT[\&quot;degree\&quot;,0.0174532925199433,AUTHORITY[\&quot;EPSG\&quot;,\&quot;9122\&quot;]],AXIS[\&quot;Latitude\&quot;,NORTH],AXIS[\&quot;Longitude\&quot;,EAST],AUTHORITY[\&quot;EPSG\&quot;,\&quot;4326\&quot;]]&quot;</code></pre>
<p>where we see that udunits and GDAL units are integrated. The
major axis lengths (<code>SemiMajor</code>) and inverse flattening are used
e.g. to compute great circle distances on the ellipsoid, using the
algorithm from <span class="citation">Karney (<a href="#ref-karney2013algorithms">2013</a>)</span>. This algorithm is implemented
in PROJ, and interfaced by <code>lwgeom::st_geod_distance</code>, which is
called from <code>sf::st_distance</code> when objects have geographic coordinates.</p>

</div>
</div>
</div>



<h3>References</h3>
<div id="refs" class="references">
<div id="ref-vim">
<p>BIPM, IEC, ILAC IFCC, IUPAP IUPAC, and OIML ISO. 2012. “The International Vocabulary of Metrology–Basic and General Concepts and Associated Terms (Vim), 3rd Edn. JCGM 200: 2012.” <em>JCGM (Joint Committee for Guides in Metrology)</em>. <a href="https://www.bipm.org/en/publications/guides/">https://www.bipm.org/en/publications/guides/</a>.</p>
</div>
<div id="ref-SI">
<p>Bureau International des Poids et Mesures. 2006. <em>The International System of Units (SI), 8th Edition</em>. Organisation Intergouvernementale de la Convention du Mètre. <a href="https://www.bipm.org/en/publications/si-brochure/download.html">https://www.bipm.org/en/publications/si-brochure/download.html</a>.</p>
</div>
<div id="ref-cobbmoore">
<p>Cobb, George W., and David S. Moore. 1997. “Mathematics, Statistics and Teaching.” <em>The American Mathematical Monthly</em> 104 (9): 801–23. <a href=" http://www.jstor.org/stable/2975286 ">http://www.jstor.org/stable/2975286</a>.</p>
</div>
<div id="ref-flater">
<p>Flater, David. 2018. “Architecture for Software-Assisted Quantity Calculus.” <em>Computer Standards &amp; Interfaces</em> 56: 144–47. <a href="https://doi.org/10.1016/j.csi.2017.10.002">https://doi.org/10.1016/j.csi.2017.10.002</a>.</p>
</div>
<div id="ref-hand">
<p>Hand, David J. 2004. <em>Measurement: Theory and Practice</em>. A Hodder Arnold Publication.</p>
</div>
<div id="ref-iliffelott">
<p>Iliffe, Jonathan, and Roger Lott. 2008. <em>Datums and Map Projections for Remote Sensing, Gis, and Surveying. Whittles Pub</em>. CRC Press, Scotland, UK.</p>
</div>
<div id="ref-iso8601">
<p>ISO8601, ISO. 2000. “Data Elements and Interchange Formats–Information Interchange–Representation of Dates and Times.” <em>ISO/TC154</em>.</p>
</div>
<div id="ref-karney2013algorithms">
<p>Karney, Charles FF. 2013. “Algorithms for Geodesics.” <em>Journal of Geodesy</em> 87 (1): 43–55. <a href="https://link.springer.com/content/pdf/10.1007/s00190-012-0578-z.pdf">https://link.springer.com/content/pdf/10.1007/s00190-012-0578-z.pdf</a>.</p>
</div>
<div id="ref-lott2015geographic">
<p>Lott, Roger. 2015. “Geographic Information-Well-Known Text Representation of Coordinate Reference Systems.” Open Geospatial Consortium. <a href=" http://docs.opengeospatial.org/is/12-063r5/12-063r5.html ">http://docs.opengeospatial.org/is/12-063r5/12-063r5.html</a>.</p>
</div>
<div id="ref-unitsrj">
<p>Pebesma, Edzer, Thomas Mailund, and James Hiebert. 2016. “Measurement Units in R.” <em>The R Journal</em> 8 (2): 486–94. <a href="https://doi.org/10.32614/RJ-2016-061">https://doi.org/10.32614/RJ-2016-061</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="updownscaling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotting.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/edzer/sdsr/edit/master/08-ReferenceSystems.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
